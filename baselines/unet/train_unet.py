__author__ = 'jonatank'
import sys
sys.path.insert(0, '/scratch_net/biwidl214/jonatank/code_home/restor_MAP/')

import torch
import torch.utils.data as data
import torch.optim as optim
from torch.utils.tensorboard import SummaryWriter

from models.unet import UNET, train_unet, valid_unet
from models.shallow_UNET import shallow_UNet
import argparse
import yaml
import pickle
import numpy as np
import random

from datasets import brats_dataset_subj

if __name__ == "__main__":
    # Params init
    parser = argparse.ArgumentParser()
    parser.add_argument('--model_name', type=str, default=0)
    parser.add_argument("--config", required=True, help="path to config")
    parser.add_argument("--subjs", type=float, help="Number of subjects for training")
    parser.add_argument("--aug", type=int)

    opt = parser.parse_args()
    model_name = opt.model_name
    subj_nbr = opt.subjs
    aug = bool(opt.aug)

    with open(opt.config) as f:
        config = yaml.safe_load(f)

    lr_rate = float(config['lr_rate'])
    data_path = config['path']
    epochs = config['epochs']
    batch_size = config["batch_size"]
    img_size = config["spatial_size"]
    log_freq = config['log_freq']
    log_dir = config['log_dir']
    log_model = config['model_dir']

    # Cuda
    device = torch.device("cuda:0" if torch.cuda.is_available() else "cpu")
    print('Using device: ' + str(device))
    print(model_name)
    # Load list of subjects
    #f = open(data_path + 'subj_t2_dict.pkl', 'rb')
    #subj_dict = pickle.load(f)
    #f.close()

    #subj_list_all = list(subj_dict.keys())
    #random.shuffle(subj_list_all)
    #subj_list = subj_list_all[:subj_nbr]
    #if subj_nbr == 1:
    #    subj_list = ['Brats17_CBICA_BFB_1_t2_unbiased.nii.gz']

    #print(subj_list)

    slices = [25346, 25359, 25365, 25335, 25243, 25342, 25250, 25296, 25309, 25350, 25288, 25319, 25378, 25276, 25265, 25264, 25324, 25337, 25271, 25366, 25300, 25244, 25260, 25245, 25339, 25375, 25311, 25313, 25290, 25357,
                      25343, 25347, 25322, 25256, 25328, 25340, 25331, 25374, 25345, 25285, 25323, 25316, 25349, 25252, 25351,
                      25364, 25317, 25330, 25239, 25240, 25314, 25332, 25280, 25344, 25301, 25286, 25363, 25302, 25274, 25315,
                      25255, 25368, 25321, 25292, 25373, 25241, 25293, 25238, 25270, 25253, 25305, 25320, 25371, 25272, 25353,
                      25247, 25333, 25304, 25254, 25278, 25279, 25299, 25277, 25294, 25369, 25297, 25251, 25361, 25283, 25303,
                      25336, 25248, 25356, 25258, 25263, 25257, 25275, 25259, 25307, 25282, 25318, 25327, 25370, 25354, 25325,
                      25358, 25376, 25262, 25269, 25291, 25266, 25237, 25329, 25362, 25312, 25242, 25341, 25355, 25360, 25268]
    # 1 Subject
        # 0 [25346, 25359, 25365, 25335, 25243, 25342, 25250, 25296, 25309, 25350, 25288, 25319, 25378, 25276, 25265, 25264, 25324, 25337, 25271, 25366, 25300, 25244, 25260, 25245, 25339, 25375, 25311, 25313, 25290, 25357,
        #              25343, 25347, 25322, 25256, 25328, 25340, 25331, 25374, 25345, 25285, 25323, 25316, 25349, 25252, 25351,
        #              25364, 25317, 25330, 25239, 25240, 25314, 25332, 25280, 25344, 25301, 25286, 25363, 25302, 25274, 25315,
        #              25255, 25368, 25321, 25292, 25373, 25241, 25293, 25238, 25270, 25253, 25305, 25320, 25371, 25272, 25353,
        #              25247, 25333, 25304, 25254, 25278, 25279, 25299, 25277, 25294, 25369, 25297, 25251, 25361, 25283, 25303,
        #              25336, 25248, 25356, 25258, 25263, 25257, 25275, 25259, 25307, 25282, 25318, 25327, 25370, 25354, 25325,
        #              25358, 25376, 25262, 25269, 25291, 25266, 25237, 25329, 25362, 25312, 25242, 25341, 25355, 25360, 25268]
        # 1 [24784, 24732, 24747, 24699, 24748, 24772, 24778, 24801, 24738, 24708, 24823, 24744, 24746, 24718, 24729, 24753, 24697, 24725, 24779, 24724, 24777, 24751, 24785, 24760, 24802, 24782, 24720, 24762, 24736, 24775, 24719, 24803, 24816, 24723, 24707, 24714, 24758, 24759, 24805, 24710, 24799, 24807, 24798, 24694, 24709, 24752, 24767, 24780, 24734, 24700, 24794, 24769, 24796, 24756, 24733, 24790, 24765, 24776, 24731, 24716, 24806, 24717, 24788, 24692, 24800, 24811, 24728, 24730, 24812, 24763, 24755, 24691, 24745, 24771, 24721, 24766, 24786, 24713, 24791, 24770, 24703, 24818, 24824, 24821, 24740, 24822, 24773, 24781, 24789, 24735, 24820, 24810, 24726, 24814, 24795, 24804, 24695, 24797, 24819, 24817, 24749, 24787, 24704, 24693, 24774, 24793, 24815, 24722, 24701, 24727, 24742, 24737, 24809]
        # 2 [10385, 10478, 10382, 10421, 10461, 10470, 10466, 10362, 10469, 10399, 10397, 10454, 10374, 10369, 10483,
        #              10420, 10418, 10433, 10401, 10388, 10380, 10368, 10370, 10436, 10464, 10455, 10363, 10432, 10424, 10438,
        #              10449, 10486, 10364, 10403, 10415, 10448, 10482, 10383, 10468, 10390, 10473, 10404, 10479, 10476, 10373,
        #              10365, 10439, 10440, 10443, 10376, 10484, 10488, 10419, 10471, 10431, 10372, 10406, 10477, 10425, 10402,
        #              10410, 10485, 10456, 10416, 10490, 10444, 10391, 10452, 10379, 10487, 10451, 10387, 10445, 10423, 10442,
        #              10480, 10465, 10434, 10378, 10392, 10381, 10489, 10430, 10371, 10475, 10405, 10367, 10429, 10393, 10474,
        #              10481, 10413, 10375, 10394, 10453, 10446, 10409, 10447, 10472, 10366, 10450, 10400, 10467, 10386, 10412,
        #              10398, 10458, 10437, 10411]
        # 3 [20001, 19987, 20041, 20067, 20006, 20068, 20074, 19967, 19950, 20005, 19975, 20013, 20035, 20058, 20014, 20027, 19980, 20029, 19978, 19994, 19996, 20044, 20061, 20069, 19952, 20028, 20049, 20018, 20063, 20045, 19971, 19968, 20033, 20076, 20070, 20057, 19961, 19948, 20064, 20071, 20040, 20002, 19992, 20059, 19964, 19986, 19999, 19949, 20050, 19983, 20051, 20023, 19951, 20075, 20047, 20054, 20052, 20073, 19956, 19981, 19998, 19973, 20066, 20016, 19991, 19946, 20026, 20046, 19944, 19989, 20038, 20010, 20009, 20053, 20003, 20065, 19982, 19993, 20004, 20048, 20017, 20032, 19974, 20056, 20039, 20024, 19954, 19976, 19957, 20031, 19960, 19947, 19985, 19977, 20019, 19997, 20022, 19972, 19995, 19970, 20072, 20020, 19984, 20042, 19962, 19958, 20060, 19953, 19969, 20012, 20015, 20011, 20000]
        # 4 [14672, 14668, 14670, 14622, 14695, 14685, 14689, 14631, 14658, 14578, 14680, 14696, 14590, 14676, 14619, 14650, 14568, 14653, 14567, 14587, 14691, 14662, 14646, 14624, 14603, 14649, 14594, 14584, 14678, 14614, 14626, 14608, 14627, 14697, 14673, 14682, 14617, 14635, 14579, 14598, 14632, 14681, 14703, 14655, 14615, 14569, 14607, 14656, 14621, 14609, 14683, 14686, 14690, 14596, 14637, 14571, 14687, 14645, 14648, 14628, 14588, 14666, 14572, 14700, 14595, 14671, 14613, 14575, 14694, 14654, 14644, 14634, 14641, 14564, 14661, 14597, 14591, 14647, 14625, 14611, 14688, 14618, 14698, 14577, 14638, 14620, 14665, 14570, 14704, 14669, 14633, 14701, 14702, 14585, 14659, 14699, 14684, 14667, 14604, 14677, 14675, 14652, 14573, 14601, 14692, 14679, 14674, 14657, 14623, 14642, 14589, 14663, 14592, 14599, 14616, 14565, 14576, 14574, 14629, 14582]

    # 3 Subjects
        # 0 [7997, 16541, 1332, 16497, 16573, 8005, 1325, 8003, 16517, 16453, 16455, 7953, 7968, 7946, 1283, 1198, 16530, 16485, 1309, 1291, 1324, 1274, 7927, 7976, 7947, 7949, 7995, 1255, 1252, 1273, 16513, 8029, 1225, 1308, 16534, 16545, 7942, 16498, 8017, 1293, 1268, 1319, 8010, 8009, 7998, 16568, 16459, 16509, 1231, 7975, 16553, 16544, 8018, 1208, 1276, 7922, 1218, 1298, 16558, 1264, 16578, 1280, 8034, 1244, 1340, 16501, 7921, 16500, 1317, 16457, 1299, 7918, 1270, 16475, 7954, 16467, 16488, 16559, 1302, 16522, 1292, 16540, 8006, 16552, 8025, 1212, 1236, 1290, 8023, 1214, 16587, 16584, 1224, 1281, 7971, 16458, 1303, 8033, 1338, 1199, 7979, 7957, 1222, 16529, 16538, 1259, 1334, 16577, 1248, 8036, 16464, 7935, 16491, 16555, 16472, 1311, 7945, 1210, 1245, 16556, 16531, 1300, 8030, 16520, 1221, 7988, 1265, 16492, 16482, 8008, 16535, 16518, 16557, 1220, 1277, 16516, 16560, 16493, 7931, 7978, 1323, 8050, 16585, 7933, 7928, 8044, 1257, 8037, 1202, 16470, 1314, 1312, 16499, 8042, 16474, 8035, 16572, 7929, 7943, 8038, 16549, 7966, 8012, 7993, 8046, 7967, 1239, 16496, 16466, 8019, 8026, 16460, 1279, 8040, 16566, 7932, 16523, 1336, 1330, 16503, 1297, 1284, 7952, 7996, 16583, 7989, 1313, 1339, 7930, 16471, 1219, 1203, 1263, 16473, 1256, 1278, 1295, 1235, 1250, 16525, 8028, 16478, 1331, 7982, 1260, 7973, 7924, 1233, 1285, 1262, 16512, 16543, 16521, 16582, 1269, 1205, 16502, 16537, 8049, 8000, 16465, 1200, 1271, 7917, 16563, 1289, 1228, 7964, 7985, 1215, 16514, 16567, 7923, 8020, 8001, 7983, 1253, 1261, 16480, 16469, 16524, 7925, 16564, 7984, 1335, 8014, 7938, 7941, 1304, 8004, 1251, 1254, 8015, 1272, 7936, 7959, 16486, 16547, 1296, 7960, 8007, 1247, 1310, 7956, 16484, 1294, 1275, 7950, 16468, 1237, 1320, 8052, 1328, 1223, 16519, 8045, 1211, 8051, 16551, 16483, 1315, 16526, 1201, 16454, 7991, 16546, 1301, 1306, 7944, 1197, 16536, 1241, 1329, 16507, 1227, 8002, 7920, 7981, 7992, 1326, 8011, 8048, 7939, 7999, 1322, 16586, 1234, 16489, 16528, 1316, 16505, 7948, 1341, 1217, 1207, 1318, 16479, 1238, 16490, 8039, 1286, 8013, 8027, 16463, 16548, 1287, 1266, 7970, 1230, 8024, 16495, 16554, 16550, 16481, 7987, 1267, 16565, 16569, 7937, 16515, 7965, 16539, 7934, 1216, 1213, 7977, 8032, 16476, 7958, 8047, 16561, 7963, 1209, 16574]
        # 1 [16693, 17077, 11643, 16632, 11711, 16998, 17078, 16979, 16637, 17009, 17016, 16711, 16665, 11705, 16708, 17037, 17002, 11681, 11726, 11721, 16627, 11660, 11615, 16987, 11600, 16691, 16609, 16697, 16630, 16616, 16591, 17001, 16701, 16629, 17014, 16680, 17025, 17058, 11679, 11603, 17073, 17013, 16606, 16664, 11733, 11614, 17036, 16643, 16976, 11624, 16698, 11654, 16657, 11632, 16620, 17035, 11611, 17068, 16671, 16589, 11651, 11646, 11648, 17007, 16997, 11629, 11634, 16628, 17056, 16700, 11663, 16605, 16639, 16705, 11602, 11609, 16614, 11658, 16681, 16621, 11700, 16596, 17008, 11692, 11631, 11727, 16714, 16646, 11677, 11649, 17052, 11729, 11671, 11687, 11605, 16692, 17040, 11710, 11672, 11703, 17070, 17054, 16593, 16625, 16981, 16592, 11695, 17067, 17076, 11688, 11713, 17015, 17074, 17100, 16996, 16988, 16635, 16653, 16624, 17057, 11690, 17098, 11701, 17010, 17026, 11642, 16655, 16602, 16703, 11708, 16658, 17088, 11636, 11689, 11657, 16590, 17000, 17082, 11662, 11718, 16683, 17043, 16618, 11638, 16652, 11730, 16983, 17023, 17034, 11719, 11647, 16675, 16626, 17047, 16597, 16607, 11685, 16669, 11617, 11709, 17046, 11735, 17069, 16604, 11627, 16666, 16677, 16672, 11633, 16710, 11621, 17083, 11622, 17062, 16706, 16651, 11616, 16649, 16984, 17064, 11665, 17018, 11606, 16636, 16670, 17028, 16638, 17061, 11717, 16662, 16633, 16713, 16994, 16640, 11728, 17102, 11702, 11612, 11625, 16985, 17019, 17006, 16707, 11723, 16641, 16644, 17003, 11673, 11731, 11659, 11699, 11650, 17012, 11732, 17065, 17096, 16611, 16694, 11686, 17094, 11637, 11725, 17092, 16656, 17044, 11712, 17104, 17029, 16699, 11669, 11715, 17042, 17050, 11620, 16704, 11664, 16647, 11618, 17027, 11640, 11694, 17020, 11716, 16989, 16594, 11635, 16601, 11661, 16600, 16623, 11734, 11697, 17039, 17071, 11655, 11623, 17051, 17103, 16709, 17060, 16610, 11724, 16617, 11644, 16661, 17093, 11704, 17059, 11684, 11674, 17075, 16663, 17021, 17066, 16684, 16990, 11696, 17030, 16978, 16673, 17048, 16991, 16974, 16690, 16622, 16645, 11599, 16685, 17084, 11676, 17087, 11698, 11722, 17053, 16975, 16995, 16608, 17031, 16687, 11680, 17090, 11604, 11652, 16702, 16603, 17005, 17097, 16696, 17049, 11682, 16659, 11610, 17072, 17024, 11706, 16980, 17011, 11608, 11653, 16642, 16613, 16634, 17081, 16599, 11619, 16678, 16679, 16676, 16668, 16712, 17086, 16619, 11720, 16682, 11626]
        # 2 [24374, 14975, 15000, 24379, 15028, 15020, 24415, 15090, 2999, 24362, 24321, 2988, 14991, 24407, 15093, 3060, 15080, 3017, 24341, 24394, 3002, 15036, 14996, 24409, 24287, 15094, 15044, 24350, 24301, 24406, 15086, 3008, 15062, 15029, 15060, 3063, 3014, 24356, 24285, 14999, 24366, 24304, 3075, 24397, 2959, 15021, 24383, 15042, 3042, 24389, 3029, 3016, 24294, 3018, 15001, 14972, 24398, 24387, 3033, 3039, 3056, 2973, 3038, 15067, 15058, 24295, 2976, 24328, 3046, 24346, 2950, 24336, 3043, 14983, 24381, 14979, 24401, 15077, 15013, 15010, 2995, 15019, 2975, 3031, 24326, 3058, 24363, 24351, 24335, 24418, 24305, 2956, 2960, 15057, 15079, 15031, 3051, 15054, 15043, 14989, 14981, 24325, 15071, 3023, 15059, 24309, 3005, 24327, 24352, 15005, 14986, 3011, 15016, 15048, 24368, 24355, 15007, 3034, 14971, 15061, 24293, 2943, 15034, 24391, 15033, 2984, 3068, 24322, 2998, 24392, 24372, 15053, 24333, 24297, 24384, 15039, 24317, 15025, 3040, 3049, 15068, 15087, 15002, 24334, 24360, 15051, 24388, 2939, 15040, 15006, 3026, 24342, 24324, 24298, 24349, 3000, 24302, 14987, 24369, 3001, 2966, 3009, 3015, 2969, 14997, 15004, 3036, 14976, 3004, 3057, 2970, 14998, 14980, 15037, 24357, 24412, 24343, 24390, 24331, 24308, 24338, 24320, 24340, 3061, 14970, 24291, 15083, 24410, 15023, 2983, 24414, 3035, 3003, 15035, 2991, 3055, 15011, 24411, 2945, 2958, 24373, 3037, 24344, 3006, 24375, 3021, 24420, 15064, 3067, 24399, 14978, 3069, 2948, 2971, 24314, 2963, 2954, 2957, 24307, 24385, 15097, 24319, 3030, 2993, 3053, 2974, 24377, 24365, 24403, 24284, 2951, 2996, 2965, 15095, 15089, 2938, 15049, 3028, 3052, 24311, 24359, 14990, 3007, 3025, 2987, 15017, 3073, 15078, 15091, 24419, 15072, 2967, 24408, 24361, 3050, 24310, 15024, 2964, 15038, 24330, 2949, 24416, 24370, 15069, 15030, 2962, 14985, 24400, 2989, 24354, 24378, 14974, 3027, 24290, 24289, 15081, 3019, 2986, 3047, 24318, 3048, 24313, 2981, 2985, 24323, 24303, 2980, 3022, 3076, 3024, 15052, 15045, 15075, 3032, 15073, 24417, 3041, 15066, 24371, 14982, 24329, 24288, 2992, 24393, 3059, 3044, 15015, 2955, 14995, 24296, 3070, 3077, 15027, 2952, 15003, 24300, 15082, 24316, 2942, 15050, 24312, 24332, 24337, 14977, 15084, 24382, 15046, 24348, 24404, 15056, 3010, 24306, 15076, 15032, 3065, 14994, 15008, 2968, 2982, 3013, 3020, 15065, 24413, 24395, 3012, 15098, 2978]
        # 3 [559, 623, 19401, 19469, 600, 10202, 19506, 10107, 546, 10092, 10097, 10223, 10123, 10193, 10206, 19399, 10180, 10140, 10175, 19463, 19427, 10096, 576, 10203, 10126, 10152, 598, 10222, 19507, 628, 542, 19429, 10155, 672, 19422, 10210, 10166, 10176, 10191, 10172, 582, 638, 568, 631, 663, 19500, 10125, 19426, 536, 10122, 10095, 635, 19424, 538, 19516, 19483, 19437, 10156, 19445, 10213, 19502, 606, 566, 585, 10171, 674, 19470, 10124, 19423, 19433, 19468, 567, 556, 558, 10184, 547, 19442, 578, 10154, 10112, 661, 594, 19504, 10151, 590, 10118, 19459, 10093, 19414, 19418, 617, 19467, 10192, 592, 10129, 19412, 19435, 10127, 10098, 10197, 570, 548, 19503, 10214, 19439, 19480, 19397, 591, 651, 19415, 19478, 10091, 561, 641, 572, 19453, 10103, 19416, 655, 19513, 19472, 664, 19434, 574, 19406, 10215, 10137, 653, 19438, 544, 10130, 622, 643, 539, 19417, 626, 662, 10209, 612, 19395, 10187, 19473, 10207, 10190, 10090, 10221, 10121, 10128, 19496, 670, 10218, 10160, 603, 624, 646, 19490, 613, 637, 10115, 19413, 19521, 640, 10220, 608, 10201, 10185, 669, 10142, 10163, 580, 10196, 550, 629, 10139, 540, 19515, 610, 19407, 19488, 654, 611, 10164, 602, 10087, 10134, 537, 19430, 19451, 10132, 19484, 597, 583, 10104, 650, 552, 10181, 19519, 555, 19494, 19428, 10131, 10204, 19405, 19476, 19475, 19393, 19420, 10116, 10216, 19425, 19499, 10136, 10094, 19465, 675, 596, 10113, 19523, 19409, 10183, 632, 19419, 557, 10182, 607, 615, 19495, 19431, 19486, 584, 19447, 10158, 581, 549, 551, 614, 639, 19482, 10170, 10157, 19501, 656, 19403, 19485, 19456, 10146, 19489, 19511, 19446, 19421, 10111, 19440, 10219, 601, 10167, 10141, 10100, 673, 10162, 19398, 19527, 627, 658, 587, 19400, 660, 19522, 10150, 586, 657, 647, 10194, 619, 10174, 19528, 10195, 19462, 671, 630, 667, 19493, 19509, 19526, 10148, 621, 19461, 564, 10211, 19432, 19452, 10200, 577, 565, 10145, 19514, 10138, 665, 19466, 636, 659, 19520, 579, 19492, 609, 19512, 19411, 10099, 10165, 19450, 605, 10212, 10147, 10101, 571, 19471, 10143, 633, 10110, 19518, 10135, 10108, 10205, 573, 19464, 10173, 10089, 10105, 652, 10189, 19392, 554, 10133, 19449, 666, 616, 19436, 575, 10102, 588, 10153, 19444, 19410, 10217, 10109, 10106, 10120, 10088, 19443, 562, 543, 545, 10179]
        # 4 [20235, 12640, 12672, 12635, 26443, 12617, 20315, 20220, 20227, 20332, 12592, 26463, 26370, 20299, 26399, 20261, 26355, 12662, 26377, 20311, 26344, 20266, 26351, 26413, 26420, 26437, 12647, 20259, 20272, 26403, 26440, 20269, 12650, 26375, 20286, 12538, 26459, 12601, 12638, 20337, 26356, 20233, 20280, 12658, 26361, 26460, 12649, 12534, 26432, 12593, 20314, 12661, 20238, 26425, 20351, 12555, 26362, 26350, 12558, 20221, 12619, 20346, 12544, 20223, 12636, 20338, 12609, 26382, 12624, 20245, 20354, 20241, 26414, 26468, 20349, 20228, 12666, 12570, 20260, 26447, 20285, 12535, 20219, 12569, 26395, 12602, 26406, 26458, 12663, 12651, 12552, 26393, 20253, 20275, 12568, 20226, 20278, 20300, 12669, 12545, 26394, 20255, 12582, 26373, 12596, 12543, 20306, 20313, 26461, 26397, 12597, 12536, 26364, 20240, 12577, 12547, 20339, 20329, 26398, 26470, 12637, 12533, 12613, 26409, 20288, 20323, 26469, 26431, 26352, 20355, 26457, 12610, 20319, 26380, 20357, 20331, 26371, 20296, 20318, 12630, 26445, 12604, 26410, 12625, 26368, 26389, 20251, 26400, 12542, 26396, 26372, 26428, 20320, 26456, 12643, 26418, 20307, 20356, 20304, 12562, 12664, 20341, 26467, 12656, 12654, 20277, 20270, 12605, 26446, 20308, 20333, 12645, 12633, 12671, 12616, 26415, 12572, 20328, 20350, 12571, 26391, 12623, 12557, 20236, 20334, 12648, 26444, 26392, 26427, 20324, 12615, 12561, 12556, 12541, 20343, 12665, 26343, 20268, 26347, 20298, 12600, 26336, 20289, 12627, 20322, 20309, 26434, 20222, 20310, 26335, 26341, 20234, 26435, 20336, 26337, 26448, 12564, 26390, 12646, 26353, 20335, 20257, 12579, 26466, 26424, 26363, 20345, 26449, 12611, 26404, 12606, 26454, 20237, 20344, 26379, 12580, 20283, 20264, 20246, 12621, 12589, 12574, 26401, 12632, 26378, 12590, 20250, 26451, 20290, 12657, 12644, 20294, 26357, 20348, 12578, 20292, 12668, 12642, 20230, 12599, 26354, 26438, 20254, 12575, 20281, 26408, 26345, 26338, 12673, 20282, 20353, 20263, 12581, 26450, 12584, 12631, 20249, 12591, 12551, 12618, 20232, 26374, 20302, 20252, 12620, 20218, 26411, 12634, 20305, 20274, 12540, 20231, 12639, 12563, 20352, 12655, 20287, 12586, 20342, 26365, 12667, 12560, 20303, 20347, 26348, 20291, 20293, 26442, 26423, 26426, 26430, 26436, 12539, 26340, 12622, 26386, 12585, 26360, 20225, 12595, 12598, 26433, 20258, 20248, 26381, 20265, 12566, 20242, 20262, 26416, 20295, 26367, 26359, 26412, 26422, 26339, 12553, 26429, 12550, 26346, 26407, 12537, 12549, 20317, 26369, 12629, 20273, 12559, 12660, 26366, 20330, 12583, 26439, 12567]
        # 5 [1611, 13026, 12977, 13029, 12625, 13019, 13085, 12545, 1723, 13045, 1696, 12634, 12673, 1684, 1690, 1653, 12995, 12535, 13062, 13089, 13079, 1699, 12971, 1677, 12998, 12613, 1628, 12609, 1652, 13046, 12616, 12604, 13056, 12643, 12978, 1735, 12565, 1672, 13065, 13058, 1620, 12599, 1664, 1736, 12591, 1704, 12610, 13009, 13037, 1681, 1651, 12602, 1728, 1627, 12641, 13074, 1633, 13075, 12647, 1643, 13039, 1697, 13020, 13005, 1744, 12537, 12636, 1676, 1717, 12574, 12542, 12973, 12562, 1635, 12617, 1701, 12631, 12605, 1724, 1655, 12550, 1706, 12970, 1693, 1729, 12954, 1683, 12534, 13008, 12666, 13071, 12642, 12598, 1670, 13057, 12662, 13025, 13040, 12648, 12568, 1713, 13059, 12620, 1675, 12571, 13069, 13049, 12671, 1687, 1716, 12659, 12630, 12994, 12999, 12661, 12988, 12553, 12608, 12963, 12670, 12584, 12577, 12586, 1712, 12587, 1679, 12556, 1732, 12957, 1644, 13012, 1710, 1645, 1741, 12976, 1715, 12614, 13000, 1654, 12979, 1700, 12667, 12635, 13082, 13054, 13048, 1702, 12582, 12536, 12590, 12985, 12959, 1719, 12645, 1686, 1656, 13084, 13002, 12575, 12656, 13042, 12953, 1711, 1726, 1665, 1682, 13061, 1678, 13088, 1685, 1649, 12564, 13064, 1631, 13017, 12967, 12660, 12600, 12595, 1718, 13086, 1714, 12638, 12653, 1733, 1705, 12618, 12597, 1740, 13087, 1661, 1621, 1640, 1617, 1707, 13018, 12982, 1632, 12960, 13067, 1646, 12544, 12623, 1666, 1623, 12606, 13073, 12559, 1668, 12955, 12538, 13004, 12639, 12570, 13041, 13038, 12640, 12644, 12593, 1709, 13063, 12992, 13035, 12547, 12989, 12972, 12569, 1698, 12546, 1742, 12557, 1636, 13022, 12540, 1734, 1659, 12580, 1746, 13027, 13011, 13021, 13044, 13072, 13033, 13077, 1609, 13013, 13028, 12637, 12669, 1695, 12657, 12956, 12663, 1626, 1692, 13051, 1630, 12589, 12965, 12555, 13032, 12672, 1671, 12650, 12990, 12624, 13023, 12603, 1673, 13047, 1624, 1657, 12541, 13055, 12601, 12539, 1727, 12974, 12627, 12543, 1738, 1745, 13015, 12561, 13014, 12563, 1725, 12578, 1730, 12651, 12633, 12993, 1691, 1638, 1662, 13078, 12622, 12969, 12581, 1615, 1689, 12996, 13043, 12649, 1680, 12629, 1674, 12968, 12612, 12997, 1694, 1688, 12984, 12549, 13076, 1650, 13050, 1731, 13031, 12615, 1667, 12626, 1720, 1737, 1629, 12652, 12665, 12986, 13016, 12632, 13006, 13066, 1669, 12573, 1739, 1658, 1634, 12554, 12987, 12588, 12576, 13036, 12962, 12983, 13052, 12981, 1721, 12533, 12980, 13068, 12961, 1613]

    # 10 subjects
    # 0 [4502, 17779, 17192, 14921, 13816, 13270, 17120, 1970, 4526, 17165, 17151, 15779, 7303, 17868, 13232, 7366, 17837, 7326, 4493, 14884, 15681, 24235, 4553, 1981, 13872, 13845, 7368, 13269, 13811, 15661, 13843, 13855, 17841, 4516, 15670, 17157, 7258, 7262, 13263, 17143, 4450, 15700, 14895, 15759, 1949, 13794, 17113, 7330, 17183, 4424, 15652, 7352, 13339, 17177, 17204, 13809, 14880, 17228, 7295, 24225, 17202, 17795, 24177, 4500, 15773, 17839, 17189, 4436, 1884, 14965, 17827, 1933, 14941, 24249, 15685, 7281, 1989, 14845, 17785, 4441, 1960, 4548, 1931, 24253, 1959, 13781, 14959, 24274, 7334, 7297, 15729, 17855, 13329, 13806, 24167, 13314, 15663, 4504, 13274, 13327, 24262, 13769, 13792, 14953, 17197, 17832, 24146, 17884, 13310, 4462, 15717, 17850, 13262, 24166, 7252, 17215, 14960, 17169, 13846, 4426, 7356, 13808, 17182, 24147, 7263, 14962, 24188, 13333, 15678, 13770, 4525, 14852, 4430, 13828, 4489, 7299, 14951, 24226, 4540, 17828, 17130, 17822, 4494, 13889, 24241, 1929, 1934, 4440, 1973, 17881, 24159, 24218, 7260, 1991, 13282, 17799, 7339, 13873, 4536, 15666, 13267, 1993, 13762, 24275, 4545, 24264, 14896, 2005, 4528, 13247, 1927, 4467, 17233, 1926, 17123, 17783, 14963, 17196, 1889, 4458, 7331, 13337, 13859, 13776, 7251, 7348, 14904, 15669, 17797, 15740, 14913, 1911, 1997, 24186, 17160, 13219, 1956, 13888, 15688, 13850, 17767, 14952, 13875, 13772, 1984, 4445, 15750, 1942, 14842, 1983, 24250, 17132, 17847, 13307, 13852, 13208, 17830, 15751, 4510, 7254, 17778, 13281, 4508, 17114, 14868, 4534, 17174, 4476, 13216, 24224, 14910, 24148, 15732, 13821, 17222, 1937, 14860, 13217, 24246, 13293, 4463, 24280, 24248, 14944, 7265, 17153, 1920, 24273, 24169, 24215, 15658, 24196, 7300, 17871, 15762, 17848, 7365, 7340, 14907, 15765, 14844, 17806, 13260, 4550, 17793, 13286, 4456, 17810, 17882, 1882, 14957, 4490, 24221, 17780, 7310, 13228, 24206, 7347, 17163, 17818, 13258, 17180, 17135, 24176, 13241, 17223, 15659, 14938, 17805, 17782, 17203, 7255, 13765, 14894, 14851, 24252, 14859, 15711, 13255, 17166, 14912, 24192, 15683, 17211, 7319, 13218, 13791, 15769, 14955, 1951, 13877, 24149, 13234, 24231, 13340, 13231, 1958, 17858, 17773, 1925, 24191, 4482, 13207, 1971, 13343, 13869, 14935, 13805, 7291, 13322, 7243, 13303, 13239, 24162, 1881, 2009, 13301, 17864, 7313, 15727, 4480, 13793, 13284, 17200, 13330, 13328, 13894, 13334, 13842, 14924, 17199, 24234, 13331, 4503, 24160, 24256, 13751, 17774, 7308, 17140, 15767, 13883, 13844, 1961, 24178, 17889, 13264, 7375, 7276, 13752, 1906, 15737, 7321, 17842, 17173, 17883, 17798, 17229, 17181, 13766, 15649, 15651, 24185, 14883, 4447, 15747, 4427, 14887, 1979, 13866, 15718, 13755, 15741, 17825, 13290, 1946, 17820, 7349, 15715, 24267, 1899, 24193, 17816, 7246, 14897, 4533, 17761, 17134, 13879, 17184, 4442, 14888, 14849, 4433, 17150, 24236, 13221, 13834, 17813, 15690, 15696, 13283, 1941, 24179, 7278, 17187, 17146, 14857, 1885, 4477, 17156, 24145, 13275, 17873, 24282, 17877, 1915, 17141, 7283, 13797, 17789, 24281, 17764, 24199, 13804, 15675, 4459, 13324, 13785, 13893, 15733, 24278, 13233, 13775, 4506, 13803, 13825, 15707, 24205, 17188, 13833, 14861, 1966, 17218, 17788, 17193, 1922, 13773, 14933, 13884, 17802, 1902, 17206, 24202, 14891, 17834, 13837, 4443, 7275, 13851, 7332, 7279, 17787, 15776, 1909, 15704, 24174, 1972, 24209, 13783, 1969, 13858, 7253, 15757, 1944, 24190, 17890, 24155, 2006, 17124, 14906, 13892, 17171, 17139, 13294, 2008, 17125, 17119, 4487, 4543, 15679, 7374, 7341, 13800, 17161, 1976, 4435, 4485, 17763, 13880, 15655, 24195, 14874, 17821, 15770, 24237, 1940, 24182, 15764, 24158, 24198, 17172, 4542, 13323, 7372, 15761, 2011, 13298, 1978, 17819, 15723, 1917, 17874, 14869, 13309, 13876, 24261, 4501, 15674, 15656, 15772, 14917, 13786, 24154, 7290, 17216, 15686, 14870, 13246, 1923, 4475, 17808, 7274, 15714, 13861, 15749, 4444, 17194, 1890, 24272, 1995, 15760, 14866, 15660, 13305, 17892, 14875, 13757, 7344, 1901, 17845, 17235, 14867, 13857, 24213, 1886, 4549, 1932, 4465, 17106, 7259, 13254, 17775, 7270, 17234, 4446, 15680, 14916, 17814, 14919, 14954, 17762, 17207, 7350, 14893, 17863, 13325, 13822, 7257, 7320, 14968, 13268, 13210, 1928, 7323, 1985, 24172, 24227, 4509, 17851, 17205, 7266, 17840, 13295, 13312, 15726, 17838, 7286, 17147, 4460, 13222, 15766, 14882, 14966, 15724, 1990, 24175, 14890, 1921, 13259, 14847, 1897, 1905, 13253, 13887, 4481, 15712, 14855, 13291, 14863, 1892, 7337, 17817, 7361, 15725, 15763, 7371, 15698, 17807, 1907, 7292, 17226, 17230, 17168, 13257, 14958, 17201, 7317, 14943, 17866, 13841, 13820, 14885, 1964, 15755, 13771, 7245, 7324, 15777, 13807, 7335, 13214, 15672, 13215, 24245, 13862, 14927, 17843, 4469, 13296, 14940, 17210, 17856, 15657, 24243, 24183, 24152, 1994, 7327, 7284, 13306, 4517, 4521, 15709, 4491, 15695, 14892, 13226, 7309, 17118, 24165, 17117, 24216, 24265, 17777, 17879, 15775, 17108, 24255, 13342, 13856, 7359, 1898, 4468, 13840, 13311, 13248, 13278, 14936, 17776, 15744, 13335, 1895, 24181, 13836, 13227, 14841, 13814, 7346, 13292, 13224, 14843, 17185, 4515, 17768, 14942, 7364, 13230, 13782, 1939, 4541, 14956, 4547, 1948, 14947, 1936, 13835, 15752, 7264, 15739, 17158, 15665, 17859, 14854, 24223, 17765, 15701, 13878, 4492, 17133, 17849, 7248, 17178, 1986, 14850, 15650, 13238, 1982, 17790, 13756, 13223, 13261, 7301, 1930, 7357, 7367, 13272, 1919, 15754, 17875, 1965, 4522, 17846, 7304, 13831, 13220, 15768, 7242, 15682, 1879, 14946, 1893, 17209, 13868, 17191, 1918, 13790, 13252, 17809, 17812, 14923, 17772, 17766, 14881, 13313, 17844, 13288, 24219, 17137, 13299, 17224, 14900, 24271, 4544, 15719, 17179, 13763, 24208, 13761, 24232, 13341, 1975, 24173, 1988, 13865, 7314, 17170, 17162, 17138, 14926, 15710, 13256, 13789, 15728, 4511, 14903, 13758, 13302, 17862, 7269, 4478, 1910, 14862, 7306, 13788, 13338, 7277, 7353, 1977, 7268, 4428, 13824, 17854, 17136, 13317, 13280, 14937, 1947, 15689, 7360, 2013, 14848, 4535, 14846, 1888, 4552, 1924, 7289, 1999, 7305, 1974, 13242, 13812, 24171, 24157, 13854, 4472, 24211, 13271, 14865, 14871, 4429, 13225, 1957, 17221, 13870, 4538, 1914, 17891, 7362, 13265, 13779, 17116, 1935, 15774, 24156, 15708, 13229, 15702, 24240, 7311, 15653, 15735, 13784, 17225, 17836, 17829, 4448, 4496, 15731, 24270, 24164, 1952, 15745, 17796, 24203, 14939, 4464, 4512, 1903, 7282, 13838, 17833, 13273, 15713, 4546, 14873, 4513, 7294, 14864, 13767, 4530, 1987, 24200, 7325, 17880, 4437, 1887, 4432, 4470, 24214, 7293, 15662, 17115, 7322, 7318, 17885, 7287, 13237, 13276, 15706, 7249, 7307, 13810, 24238, 17823, 24263, 14920, 4505, 1996, 4486, 14889, 17870, 14858, 13279, 13212, 17786, 4523, 4457, 13801, 13319, 24276, 14932, 24210, 17824, 15722, 4439, 17781, 15667, 4531, 13867, 24258, 15734, 13336, 14925, 17784, 15716, 4425, 7355, 7358, 1938, 24259, 1891, 13285, 2002, 13236, 24212, 4479, 4474, 15703, 13315, 17126, 17232, 24242, 13787, 13760, 7244, 17214, 14909, 4527, 13780, 7312, 13768, 14905, 4431, 2000, 4537, 14915, 15736, 4484, 24229, 14950, 17144, 7338, 17872, 4519, 15692, 15758, 17154, 17792, 13817, 15694, 13853, 4449, 13826, 15778, 7328, 14934, 7354, 4422, 24170, 24277, 15668, 15699, 2010, 17811, 7329, 13795, 24168, 13244, 13849, 4498, 17195, 13266, 13799, 24230, 13798, 17800, 24222, 4434, 13213, 24197, 14914, 17128, 17803, 1967, 7369, 14878, 1900, 14948, 13895, 17111, 14931, 17155, 24228, 1963, 13251, 4507, 13827, 17212, 7250, 4495, 4466, 13874, 7363, 7298, 17217, 17236, 24279, 14908, 14929, 17109, 1913, 7267, 14853, 17208, 17760, 14961, 1992, 17122, 1943, 13277, 17860, 7261, 1916, 13860, 1883, 4454, 24260, 15697, 4438, 13890, 17145, 13289, 17791, 24201, 17826, 4452, 17220, 17219, 17149, 4423, 13249, 14898, 17110, 14928, 17112, 1953, 15687, 15743, 14876, 13818, 13297, 13891, 13316, 4488, 24163, 7280]
    # 1 [26224, 25064, 19765, 19730, 25018, 22097, 9462, 15215, 15186, 19762, 9424, 26311, 25100, 19681, 15189, 26270, 19753, 23423, 26236, 15138, 9541, 19534, 25042, 19719, 19693, 22522, 9463, 13036, 22637, 26274, 13060, 19602, 19634, 19759, 13018, 12991, 22011, 26276, 15157, 19577, 22050, 19744, 19557, 25067, 13033, 23339, 19717, 24994, 23390, 19599, 15109, 19626, 22008, 24965, 13066, 19797, 13072, 9474, 22592, 19807, 19553, 13037, 23351, 19685, 19636, 26273, 13024, 13030, 22565, 25033, 23448, 23380, 13067, 13054, 22631, 15212, 22037, 22617, 23458, 22058, 22640, 15155, 22103, 26250, 9511, 19558, 22036, 15210, 26201, 25026, 9422, 15161, 15221, 19746, 9448, 24987, 13025, 24992, 26221, 26323, 15199, 12966, 9420, 22546, 19591, 23433, 15139, 15145, 9536, 22084, 22064, 26307, 19575, 23350, 26325, 13009, 15170, 19616, 9534, 15107, 26248, 23361, 19758, 25079, 22537, 26290, 22105, 12974, 9435, 15194, 25009, 26291, 22095, 19622, 22642, 19805, 22040, 22604, 22023, 26305, 19587, 13081, 23381, 19578, 19563, 25032, 9481, 22570, 22044, 19539, 13088, 13020, 19726, 22020, 25048, 19642, 9498, 15217, 25060, 22622, 13070, 15153, 12986, 19567, 12969, 19706, 19716, 9543, 21997, 9506, 9507, 25022, 15177, 15174, 23329, 22620, 21986, 13028, 22605, 25051, 23441, 19600, 21988, 25041, 19610, 22614, 13027, 19620, 25000, 25004, 26319, 22076, 12982, 25066, 22579, 26220, 15132, 24967, 26227, 25014, 19796, 25089, 22009, 19541, 9491, 13005, 26213, 25070, 19804, 23455, 9535, 19551, 22051, 22535, 19594, 19627, 22074, 15103, 22649, 23362, 19684, 22012, 13079, 22545, 19786, 22045, 22621, 22047, 19799, 26266, 23412, 25072, 19628, 22554, 21976, 22532, 19544, 19569, 9413, 13039, 26313, 15147, 9499, 9454, 19540, 15100, 26251, 22015, 9542, 19586, 22648, 9445, 23363, 9523, 9487, 25015, 15117, 19649, 19583, 25046, 22542, 9475, 25099, 9464, 25029, 22004, 13073, 19763, 22527, 26312, 23392, 19555, 22628, 9545, 25039, 23443, 19803, 23428, 12972, 25078, 13046, 19661, 15113, 15137, 25086, 19808, 26284, 19571, 9415, 23446, 19718, 15198, 19752, 25087, 15152, 19592, 15220, 19658, 25031, 12961, 15227, 13069, 24974, 9471, 21975, 22596, 23331, 15183, 23410, 19542, 12971, 25076, 19712, 19792, 26217, 12954, 19675, 13003, 25058, 22616, 22607, 19604, 9441, 19556, 23373, 13040, 25054, 22584, 26301, 19573, 13012, 19621, 26281, 13007, 24988, 25016, 22091, 26316, 19743, 23399, 15200, 22597, 22634, 24980, 22003, 22080, 13048, 26320, 26218, 19663, 12998, 15134, 22007, 19771, 26333, 23341, 25059, 19532, 19543, 22541, 22633, 13050, 21981, 22536, 9496, 13014, 25021, 15122, 21994, 9472, 23405, 26279, 15164, 23402, 13044, 19734, 19653, 15140, 25081, 19606, 23447, 23349, 9504, 19776, 19652, 15148, 22093, 19619, 25053, 9455, 15203, 15124, 15184, 12983, 19537, 19646, 15209, 19595, 19705, 26231, 13051, 23398, 19659, 26272, 13071, 22010, 15156, 22618, 22043, 13023, 22090, 19536, 22639, 25020, 23404, 13029, 23356, 22033, 26299, 22002, 23343, 21979, 15163, 15143, 22089, 15128, 9509, 25071, 23378, 22019, 22567, 19751, 22056, 15111, 9467, 26269, 22057, 19750, 15125, 22589, 15131, 26286, 22586, 19800, 15223, 19608, 19760, 9538, 13061, 15106, 19697, 19729, 25102, 19549, 15222, 19739, 12964, 9526, 26243, 9452, 19696, 12994, 26208, 22024, 22638, 19692, 15193, 19695, 19580, 15169, 26209, 19564, 23337, 15219, 15127, 13011, 13085, 19603, 19782, 25001, 19699, 15135, 22054, 9520, 26229, 15104, 25073, 9457, 25040, 13075, 23437, 21984, 15185, 15172, 15195, 13022, 25008, 26296, 19794, 15142, 19667, 26238, 26280, 9531, 9418, 25098, 13076, 25037, 13016, 22575, 9438, 19632, 22558, 9497, 9517, 26222, 23401, 24989, 26239, 26332, 23431, 9414, 22538, 15102, 21974, 24996, 19576, 9428, 13078, 15116, 15213, 9478, 23420, 26321, 22075, 15197, 22543, 15129, 22046, 22560, 25043, 26315, 19533, 24997, 26293, 22073, 24966, 22653, 22613, 24972, 25095, 19535, 9492, 19725, 24991, 22085, 26303, 19548, 15173, 19584, 22573, 23345, 22523, 22623, 19785, 19748, 9488, 26302, 23436, 26285, 23413, 15114, 19643, 26215, 15167, 19562, 21980, 19546, 15216, 19767, 24975, 23439, 24986, 15159, 25017, 19656, 26226, 25062, 23415, 22643, 22028, 19579, 9519, 9510, 22088, 22066, 23358, 19687, 23451, 9450, 12978, 21987, 22590, 9425, 25080, 9451, 9484, 22578, 19618, 22061, 15136, 26212, 22576, 25027, 25012, 9446, 26278, 26256, 26202, 22528, 26257, 19742, 22612, 15123, 9530, 19670, 19806, 19598, 25082, 12987, 19612, 9485, 13001, 19727, 26295, 23425, 22563, 25090, 23353, 15112, 22099, 13077, 19722, 25093, 19633, 25085, 22626, 19582, 9524, 23426, 13032, 24995, 19694, 19709, 19775, 12973, 22052, 9532, 22030, 22561, 22588, 19566, 19574, 25030, 23379, 13002, 9540, 22600, 19552, 9453, 19713, 23427, 19601, 12979, 13034, 12996, 19635, 19665, 23395, 25003, 19738, 26252, 9466, 26259, 19630, 9449, 24982, 26306, 22568, 12962, 19559, 22581, 19588, 25077, 22014, 19789, 22106, 9500, 13015, 23442, 19755, 26322, 19617, 23385, 19802, 22063, 25023, 22593, 19690, 13041, 19772, 22553, 23344, 22029, 25056, 15211, 9528, 24969, 22582, 23407, 19768, 19645, 9483, 22654, 26300, 22018, 15149, 22083, 23333, 25019, 19572, 26244, 22566, 21996, 9527, 22632, 13019, 25096, 25097, 9436, 22022, 21989, 26334, 23386, 26310, 15154, 12981, 9423, 19679, 26324, 23366, 12985, 13084, 9513, 24984, 23419, 12975, 12977, 26232, 13010, 13013, 19689, 12955, 19779, 9529, 22572, 21985, 15166, 9503, 22583, 19764, 19529, 22625, 26234, 22574, 23421, 19761, 15179, 19732, 23408, 13021, 26309, 23355, 19711, 15168, 25010, 19728, 23391, 22071, 26277, 23440, 19638, 23367, 26275, 15224, 25049, 22594, 22599, 9544, 15207, 9508, 22556, 12958, 19737, 22067, 26261, 23347, 22104, 15118, 19531, 25075, 26326, 15180, 15108, 22646, 22065, 9444, 19648, 13083, 22591, 26297, 22072, 15218, 21991, 24978, 22630, 15226, 25006, 23371, 23335, 24970, 9477, 19714, 13053, 22048, 15192, 15160, 19597, 15162, 22521, 9456, 9468, 22041, 9440, 25024, 23463, 25038, 9434, 15101, 13045, 19655, 22577, 9465, 15204, 26205, 15165, 22017, 26265, 22540, 24977, 22081, 19641, 19611, 23346, 22636, 23354, 9480, 22585, 9460, 23393, 19770, 19677, 22026, 21992, 12997, 24990, 22025, 19774, 26264, 26240, 19680, 15105, 26216, 22651, 19787, 23460, 25101, 23411, 19660, 19650, 9426, 19673, 26258, 9522, 13052, 12995, 23360, 26214, 26206, 25011, 21999, 22624, 23418, 23403, 22001, 22644, 9502, 19538, 13074, 19651, 22055, 22032, 26329, 25044, 26288, 15187, 25057, 19745, 9430, 23394, 13068, 19590, 22101, 19637, 25005, 22559, 22525, 19629, 24985, 19723, 19623, 9537, 25007, 15178, 19778, 22647, 19757, 26245, 19749, 19715, 26242, 26267, 15175, 25068, 19710, 19731, 22650, 12989, 22000, 19798, 19657, 22096, 9459, 23445, 19530, 19707, 22550, 15151, 19809, 15190, 22086, 25055, 12988, 22013, 23382, 15208, 21990, 19788, 13059, 22611, 15171, 23340, 13047, 23376, 13038, 26254, 23459, 9501, 22038, 22533, 19783, 19741, 19756, 25035, 19708, 13017, 22635, 19720, 9437, 15206, 23452, 23400, 23435, 24993, 23338, 15225, 22595, 19547, 26253, 25069, 13026, 15126, 9458, 19669, 9470, 22555, 19614, 22603, 22569, 19570, 23332, 12990, 23432, 26262, 22078, 22092, 22087, 9417, 19545, 23374, 19704, 23397, 19589, 24998, 19666, 13043, 13031, 19672, 15181, 19691, 19639, 15130, 23384, 26204, 23357, 12953, 15115, 26308, 13064, 23388, 19561, 26318, 9486, 21993, 23417, 19791, 13004, 15201, 9489, 26260, 12992, 15176, 22053, 26304, 22027, 9431, 23457, 15191, 24981, 19647, 22547, 22098, 22094, 21977, 19780, 26327, 19781, 9512, 19735, 22062, 23461, 23450, 12959, 22042, 12999, 26271, 15119, 22598, 26203, 22552, 25002, 22082, 22601, 19777, 22070, 21978, 19615, 26287, 19793, 9419, 15120, 13042, 22530, 9476, 15141, 22039, 23438, 23454, 19631, 15133, 9416, 19625, 24973, 26241, 15188, 23414, 25052, 15202, 26292, 12976, 25013, 26268, 19674, 19784, 23365, 25083, 19754, 15196, 23456, 13006, 23389, 24999, 9432, 26317, 25034, 22035, 26207, 19605, 9439, 13058, 15150, 9494, 22021, 24983, 26328, 15182, 22077, 25074, 23342, 25092, 22529, 26255, 22102, 9443, 26282, 19701, 23330, 25088, 19703, 19550, 13062]
    # 2 [5552, 6583, 14525, 7177, 8335, 16425, 8447, 14455, 14537, 6580, 16986, 5564, 18455, 17028, 11185, 8439,
    #              16433, 8344, 17073, 18440, 8418, 16381, 7174, 5574, 11078, 8346, 11063, 11064, 18536, 6672, 11157, 5587,
    #              5528, 17049, 7153, 5554, 6622, 16998, 7222, 1386, 18527, 17065, 16410, 14555, 7170, 6627, 11138, 1419,
    #              14477, 8404, 18553, 7133, 16363, 17031, 6673, 6679, 16347, 11154, 7115, 11141, 7183, 11105, 16387, 6661,
    #              7237, 7199, 18429, 14427, 1346, 17077, 1473, 1469, 18546, 8316, 18479, 16444, 14497, 18460, 5533, 6649,
    #              16351, 5580, 8331, 5590, 7175, 1398, 14515, 11065, 7223, 6581, 1417, 16321, 5593, 16403, 7226, 8417, 7194,
    #              1407, 11166, 7234, 8430, 5536, 6609, 8453, 18523, 14479, 18552, 11148, 6640, 11178, 17038, 17043, 6668,
    #              18564, 5575, 7186, 6652, 5605, 11168, 5577, 7206, 5570, 7184, 16980, 11107, 8416, 18469, 8427, 8333, 6601,
    #              6698, 11083, 6603, 11069, 5609, 6633, 8321, 11057, 7239, 14558, 1456, 7233, 14481, 16356, 11072, 16382,
    #              11085, 6675, 14475, 1372, 18486, 6647, 11147, 11096, 14540, 1373, 16383, 18472, 11177, 16389, 5568, 11115,
    #              16452, 1427, 6599, 11128, 7156, 7169, 6688, 16378, 14513, 18528, 7118, 14509, 8345, 16985, 7176, 7219,
    #              17008, 14467, 6690, 1364, 5602, 6612, 1438, 8357, 18498, 5548, 14428, 7110, 6579, 5615, 1357, 6596, 1416,
    #              1430, 16361, 16331, 6617, 5603, 8406, 6613, 14510, 17040, 7162, 5517, 18436, 14546, 7154, 14445, 16337,
    #              16323, 5571, 5535, 7230, 8353, 14505, 5573, 11169, 18493, 8369, 7150, 5610, 17041, 5537, 5532, 17103,
    #              14516, 5567, 14511, 11081, 6593, 18567, 16384, 17005, 14541, 7180, 8393, 6582, 5555, 17027, 5529, 5511,
    #              18478, 14474, 5560, 5495, 14507, 7126, 18470, 1454, 18448, 8412, 6637, 17104, 1397, 5527, 18541, 6625,
    #              11117, 6636, 17061, 16349, 17064, 1389, 8336, 11179, 16359, 11060, 7123, 14560, 18516, 7236, 16977, 11139,
    #              11095, 5522, 16420, 18467, 8383, 14520, 8438, 16409, 5513, 14450, 8330, 7143, 5534, 16412, 5509, 17046,
    #              16342, 8328, 16438, 8382, 16978, 18525, 7238, 18496, 1384, 8429, 7201, 11111, 17004, 1464, 8363, 11074,
    #              6595, 14542, 6618, 14529, 16990, 14522, 16430, 11183, 7221, 8322, 7215, 5619, 11062, 5556, 17056, 6691,
    #              16368, 16376, 11153, 7120, 7240, 18450, 7135, 11084, 18513, 8450, 6648, 14438, 14476, 8332, 5565, 7224,
    #              16997, 18494, 8339, 6662, 6571, 17009, 17081, 6697, 14538, 17034, 5588, 14433, 8421, 14480, 16996, 16414,
    #              17037, 6608, 16338, 5521, 7190, 5604, 14435, 1355, 16328, 8377, 11093, 7173, 1368, 17024, 18560, 17014,
    #              16398, 8449, 1361, 5549, 6592, 8329, 14464, 14459, 11156, 7192, 7165, 11137, 16417, 16327, 16386, 8365,
    #              14549, 8431, 7119, 14561, 18540, 16446, 6689, 11181, 8318, 17080, 14536, 18439, 14425, 1468, 18491, 8366,
    #              17047, 7108, 18562, 17057, 8374, 16437, 11067, 1445, 18566, 14466, 17025, 14494, 7137, 6657, 6577, 17072,
    #              6570, 11119, 18452, 18462, 18477, 7227, 6584, 11075, 11094, 14524, 14506, 8372, 5566, 7144, 1463, 18481,
    #              5515, 18480, 6616, 17022, 11145, 17029, 11144, 8347, 1451, 11120, 5594, 18504, 11123, 18482, 14431, 14486,
    #              17066, 18432, 17094, 5499, 6606, 6569, 8396, 6598, 18434, 14443, 5496, 1354, 14426, 16397, 7134, 16979,
    #              1439, 1351, 11109, 16983, 16344, 1400, 6620, 17083, 8327, 14548, 8354, 5543, 5500, 7127, 8432, 16402,
    #              17051, 18547, 11073, 16434, 5582, 16396, 1424, 16441, 18529, 7225, 5586, 16436, 7231, 6621, 17039, 16988,
    #              16370, 6645, 18499, 11106, 6575, 7114, 1380, 8370, 18500, 1448, 5516, 18484, 1466, 16353, 7129, 5514,
    #              16393, 5508, 17097, 5561, 18543, 5613, 8437, 6623, 16429, 16336, 8342, 1344, 7209, 18431, 8408, 6619,
    #              14430, 18444, 11068, 8435, 7159, 8334, 5539, 11090, 6597, 11136, 6605, 7228, 17091, 1443, 18453, 16395,
    #              18532, 17033, 11071, 8364, 8361, 18548, 7131, 6680, 1465, 16426, 14424, 7158, 17021, 18456, 8387, 17093,
    #              14436, 8413, 16330, 8425, 11077, 18522, 6629, 17055, 16992, 14446, 18569, 5617, 17085, 6628, 11174, 18485,
    #              1452, 14551, 18561, 6586, 1394, 14432, 18551, 11101, 11086, 18502, 7138, 11175, 1431, 16443, 1418, 18565,
    #              1455, 8381, 1345, 8337, 11172, 18442, 17001, 1365, 5616, 7140, 5591, 16422, 16435, 8443, 6635, 6643, 1412,
    #              14532, 5562, 6631, 16350, 1423, 1432, 16343, 16447, 8451, 18464, 11087, 6694, 14485, 11155, 5557, 5600,
    #              16415, 17016, 18537, 14449, 6574, 11100, 6696, 8326, 8348, 6677, 14531, 11134, 1362, 7235, 1352, 17007,
    #              8359, 17023, 16419, 16982, 18438, 1428, 6664, 14482, 18568, 6588, 1376, 17069, 18465, 14484, 11160, 11052,
    #              5572, 16421, 18445, 11082, 14495, 6578, 18559, 14543, 16340, 6660, 14458, 7130, 5510, 1379, 6687, 14434,
    #              14512, 14465, 8452, 8423, 17100, 17012, 1395, 1353, 7187, 16325, 1411, 7198, 1467, 18544, 17017, 7163,
    #              1434, 16423, 6700, 8371, 6638, 8352, 11061, 18554, 18521, 6681, 8426, 18451, 6670, 8351, 8445, 6600, 1363,
    #              14535, 17013, 17048, 1358, 8368, 16424, 11097, 18463, 5526, 18474, 14521, 5583, 16373, 18557, 14429, 8380,
    #              7147, 17098, 11126, 14499, 11056, 8400, 18556, 11099, 6676, 17070, 16411, 1392, 16352, 16365, 1449, 17003,
    #              1436, 5589, 17090, 18526, 14496, 7146, 18517, 16377, 8402, 1429, 16431, 1396, 11114, 16994, 16375, 14517,
    #              1461, 1360, 6590, 14502, 6646, 16362, 11108, 7204, 8391, 18483, 7160, 17019, 16335, 5531, 16360, 6666,
    #              16991, 16371, 16995, 7193, 14559, 8424, 18447, 8373, 1369, 7197, 16341, 11079, 6604, 11110, 18454, 11135,
    #              18520, 14454, 18490, 8392, 6693, 5538, 17067, 17006, 6702, 16346, 14518, 17088, 17075, 11159, 1440, 7112,
    #              16374, 5542, 5558, 18446, 1459, 8389, 17032, 1457, 6683, 5578, 17095, 16391, 17076, 5524, 1385, 14544,
    #              5530, 1405, 14547, 6671, 7142, 1378, 14552, 11092, 7121, 8401, 6587, 1472, 11143, 8388, 17015, 5606, 16974,
    #              17044, 18518, 1359, 18473, 7218, 11164, 11173, 6607, 18550, 6678, 16332, 8403, 8440, 17053, 6658, 1421,
    #              8362, 8441, 6651, 14492, 8378, 7182, 14490, 18558, 5614, 1393, 18488, 16404, 11091, 11051, 18509, 16406,
    #              8442, 18503, 11133, 11116, 6632, 6630, 1415, 11070, 6669, 16976, 1349, 7217, 1347, 11122, 7155, 1348,
    #              16449, 8317, 7124, 17086, 8386, 5559, 16993, 8375, 8407, 14471, 11050, 5497, 16451, 16345, 18449, 1444,
    #              17074, 8356, 1367, 14468, 5620, 8420, 8434, 7171, 6665, 11104, 8324, 6602, 7229, 7117, 7113, 18563, 7111,
    #              8446, 14498, 7125, 6576, 1404, 14453, 16392, 8419, 16440, 17000, 8379, 11162, 7188, 18533, 1406, 5597,
    #              17092, 17050, 11171, 1401, 11113, 8444, 14440, 18538, 7212, 7202, 11146, 18570, 7213, 6655, 18545, 16399,
    #              1409, 6650, 17082, 17060, 5519, 6591, 1408, 14563, 6704, 5498, 17096, 16326, 16394, 18555, 18471, 16369,
    #              7157, 16358, 7191, 7179, 6594, 14534, 11127, 14489, 1399, 7216, 16999, 7207, 7166, 14501, 5525, 14487,
    #              7148, 18542, 11150, 11158, 18508, 11129, 14533, 8319, 5518, 16981, 1426, 5607, 14451, 14441, 7136, 16450,
    #              5551, 11076, 18457, 7210, 14530, 18468, 18475, 8350, 7200, 18524, 6703, 8390, 18437, 1403, 1442, 11080,
    #              7151, 17062, 5504, 17078, 5584, 8399, 18531, 17011, 18507, 16390, 11176, 18535, 11151, 14557, 14491, 8433,
    #              8338, 16348, 14554, 1366, 6659, 1450, 18506, 18458, 18425, 16413, 16333, 1350, 14472, 8384, 16442, 1342,
    #              14493, 5592, 7149, 18443, 7181, 11152, 5540, 16987, 7211, 18514, 5544, 6573, 16439, 14514, 17020, 1453,
    #              7145, 11182, 1383, 18428, 18510, 7232, 1435, 16354, 16400, 5576, 14528, 16428, 18466, 8395, 16405, 18461,
    #              5611, 7189, 1377, 5596, 7109, 7164, 8414, 11161, 16408, 14447, 14556, 11055, 1446, 5595, 17099, 16427,
    #              7203, 11140, 6610, 17030, 6641, 5502, 11089, 14504, 1447, 17059, 8397, 1441, 6614, 6615, 14444, 6572, 1422,
    #              1381, 5520, 5563, 8422, 6692, 18459, 1414, 8343, 1343, 1391, 6699, 5579, 16324, 8428, 5547, 14545, 8385,
    #              1413, 11125, 11149, 8341, 11118, 5581, 14503, 5507, 1425, 18549, 14463, 6624, 5601, 14456, 1370, 16445,
    #              7168, 7122, 6682, 8448, 6701]
    # 3 [25170, 25780, 13124, 18694, 13095, 1876, 13195, 25221, 13116, 25220, 13140, 1863, 9522, 25103, 13177, 20386, 25680, 12434, 9431, 19825, 13105, 18613, 13172, 9428, 25761, 9450, 19826, 25747, 25866, 25755, 18572, 20367, 12416, 25913, 1770, 20493, 25192, 1847, 12414, 1805, 25783, 1815, 25897, 20457, 9545, 20433, 25862, 20437, 9471, 20410, 12507, 18624, 19898, 12519, 25160, 19828, 25920, 18652, 18683, 12474, 25661, 9536, 25106, 20449, 9437, 9530, 25760, 25157, 12470, 25902, 9485, 1867, 25135, 25734, 18673, 13174, 19939, 18658, 25792, 1873, 12484, 20381, 25799, 13101, 18699, 9511, 20478, 25931, 25730, 1801, 19933, 18661, 25224, 9425, 1787, 18700, 9468, 25127, 1813, 20389, 19920, 12431, 13134, 25187, 13112, 12493, 25763, 25678, 25815, 1858, 9502, 20415, 12476, 19820, 19887, 20491, 12404, 20481, 25172, 1790, 25724, 12485, 19910, 18657, 25863, 12472, 25793, 1753, 12514, 18679, 25750, 25164, 1850, 12491, 1877, 1824, 25184, 13200, 25222, 20423, 13119, 12499, 18698, 13109, 19843, 12502, 12440, 25865, 25725, 18593, 12505, 25117, 20379, 1796, 18687, 19829, 18650, 25124, 25871, 12412, 13190, 25712, 19877, 12449, 25808, 25715, 19899, 19881, 18659, 18685, 20456, 25806, 25727, 25758, 25857, 9414, 18610, 20460, 19880, 18586, 25193, 25802, 1830, 9458, 9426, 20365, 19895, 18602, 1757, 13117, 13110, 1812, 13098, 19857, 19940, 20399, 20430, 25759, 20473, 25812, 9505, 25709, 19942, 18625, 9419, 12463, 19907, 25216, 25748, 25699, 9492, 12430, 25892, 1819, 1874, 9515, 1843, 25753, 18654, 25811, 25660, 1756, 25137, 25813, 20382, 25118, 25131, 9482, 20453, 13097, 1823, 25673, 1826, 25214, 20476, 25698, 12526, 19841, 12433, 25867, 25869, 19926, 19813, 13194, 13198, 25859, 20364, 20472, 9463, 25907, 9529, 19815, 19930, 18697, 25820, 13135, 20424, 12442, 25729, 12447, 9442, 18609, 1871, 1852, 25884, 12466, 20402, 25691, 9541, 25751, 19817, 25839, 25196, 18631, 13179, 9520, 1841, 25779, 12475, 1832, 1811, 25749, 12459, 13180, 25909, 18651, 19850, 1760, 1818, 25695, 9459, 18674, 25115, 9470, 25772, 25788, 25733, 12504, 13131, 25923, 18663, 25683, 12513, 9427, 20461, 9539, 13181, 1800, 13123, 18584, 25744, 19868, 13092, 12452, 9526, 25853, 25201, 18638, 9447, 18646, 19914, 25726, 18630, 9514, 13125, 25212, 12488, 20429, 18670, 20431, 25119, 1762, 19925, 25778, 19864, 25142, 1771, 25166, 12461, 1825, 25236, 19928, 19818, 19922, 25235, 9413, 13176, 12426, 20469, 20406, 12424, 19823, 25870, 9500, 9521, 25110, 20388, 25787, 19886, 9455, 13162, 20400, 25178, 1784, 25878, 25832, 18627, 20477, 9480, 25232, 9507, 9417, 25133, 12489, 12520, 25700, 20462, 25798, 12437, 25922, 12486, 12448, 13175, 9474, 13114, 18574, 13136, 12462, 20463, 12415, 18640, 13115, 20377, 25202, 1807, 20474, 18645, 19845, 9519, 25786, 25880, 25855, 18629, 9516, 12450, 12444, 9418, 9475, 18620, 9478, 19935, 1846, 25667, 25677, 25152, 19913, 25926, 1791, 25671, 18604, 25856, 18589, 13100, 1752, 20413, 13163, 18690, 25191, 12406, 25163, 12417, 25116, 25719, 12492, 25740, 13126, 13094, 19866, 9495, 19931, 19812, 25225, 13127, 20471, 13147, 12425, 1868, 19839, 19847, 25771, 1814, 25824, 18578, 19822, 25208, 9538, 25186, 20484, 19893, 25890, 25702, 18664, 9513, 9476, 12516, 20397, 25905, 13132, 25899, 13186, 25189, 1810, 9461, 25769, 12478, 1856, 20385, 12432, 19908, 18648, 13204, 25757, 1839, 9445, 13192, 25104, 25746, 20363, 25151, 1750, 18598, 12438, 19894, 19876, 18671, 25146, 25722, 1809, 12421, 1862, 1768, 13106, 13108, 1834, 12482, 1792, 13150, 9423, 12407, 25219, 25169, 12503, 9510, 12512, 12532, 25918, 12423, 1789, 13197, 9493, 13152, 9466, 20414, 1747, 12509, 25188, 19810, 25916, 12464, 25845, 25150, 13146, 19923, 20492, 1836, 20480, 25851, 18582, 13113, 25743, 25785, 9440, 12517, 25218, 18594, 18653, 25693, 25223, 9435, 19874, 20369, 25889, 1821, 13142, 9488, 13189, 20362, 19840, 13171, 19891, 18643, 9504, 13161, 25694, 12446, 1786, 20454, 20468, 19927, 9508, 20398, 19831, 20435, 9490, 25136, 9462, 19833, 20465, 25805, 18628, 25908, 19848, 20426, 25144, 25664, 1778, 25789, 1761, 1808, 18619, 18590, 1749, 18618, 13160, 25665, 19906, 20416, 20418, 25199, 1875, 25656, 13120, 1781, 12477, 9436, 25655, 9487, 12429, 20395, 19903, 18641, 1857, 1772, 18689, 18612, 12435, 13133, 1765, 20447, 9498, 25668, 25777, 25676, 25925, 12469, 9496, 25770, 9497, 13151, 18656, 25915, 25775, 19934, 12402, 25831, 25159, 25211, 1803, 13167, 25791, 20459, 25666, 19918, 1866, 19834, 9524, 25711, 19838, 25173, 19811, 9457, 20432, 12458, 1833, 25852, 13153, 13138, 25176, 9494, 20446, 9543, 9448, 1820, 25231, 12411, 18675, 25129, 9534, 25147, 25158, 25841, 19937, 20489, 12454, 18693, 25735, 12481, 18617, 12525, 1773, 12473, 20390, 12420, 19875, 25230, 25818, 18622, 25658, 9527, 13093, 18639, 20436, 25140, 9472, 12501, 12497, 13096, 25209, 25149, 1851, 18607, 12456, 18591, 25684, 12457, 19844, 20378, 18571, 25896, 25148, 1806, 25790, 12418, 18672, 18688, 25876, 1842, 18667, 20428, 25837, 20421, 20368, 9444, 13187, 12498, 1844, 25679, 9512, 13183, 12467, 25927, 18642, 19905, 19814, 25705, 12453, 20425, 13206, 25914, 20422, 9501, 18668, 20393, 18585, 18595, 12436, 25675, 12496, 25756, 1840, 1793, 25868, 9443, 12428, 9449, 19932, 13169, 9481, 18649, 25120, 20467, 18647, 25687, 1853, 25921, 19867, 19836, 9491, 1872, 25198, 19865, 25714, 18644, 25670, 25817, 25894, 18680, 25796, 25207, 25826, 19819, 13102, 9439, 19919, 13104, 19943, 9416, 13128, 1777, 12480, 25153, 25190, 13118, 20360, 25145, 25767, 12409, 12408, 18684, 13168, 25182, 19859, 1779, 25155, 25122, 25168, 25657, 20487, 12529, 19885, 9429, 12518, 25903, 25842, 25663, 25682, 25203, 20490, 19921, 18581, 20486, 13170, 19929, 25109, 19853, 13149, 18577, 18696, 12451, 12439, 12479, 12468, 18677, 13107, 12487, 25810, 19883, 20412, 25823, 25204, 1865, 13202, 25703, 25175, 25861, 25662, 1837, 25229, 9537, 25850, 9469, 13191, 19900, 9434, 19892, 25121, 25858, 20404, 19873, 1835, 25696, 25784, 18660, 1827, 25901, 25834, 20371, 1799, 12495, 25162, 25829, 13130, 25177, 25692, 25134, 19827, 1798, 13185, 25864, 20361, 19879, 1780, 1751, 25228, 12441, 25885, 9453, 1764, 9532, 13111, 19856, 25872, 19837, 9477, 12523, 9465, 19821, 20450, 19890, 20458, 25669, 25814, 25825, 19871, 25795, 1860, 25111, 20392, 20445, 20407, 13203, 25738, 13129, 1748, 1795, 9533, 9479, 18616, 18623, 18575, 25732, 25794, 25844, 20440, 13148, 25912, 25900, 9525, 1838, 12528, 25877, 25180, 25893, 19941, 19936, 13137, 12527, 25742, 1794, 25672, 1854, 25819, 25833, 25128, 25143, 20374, 13145, 25774, 12419, 12422, 20359, 25886, 18655, 12524, 1804, 12522, 25113, 25707, 25804, 9473, 25723, 25745, 19916, 25830, 20383, 20391, 13193, 19884, 13103, 19882, 20420, 13199, 1802, 25167, 12490, 18573, 18632, 1849, 18579, 25165, 25847, 25689, 20466, 19861, 1774, 13188, 25125, 18608, 25843, 12494, 20384, 9460, 20405, 25215, 9438, 25891, 20485, 12471, 9464, 18614, 25854, 25688, 20439, 19830, 25686, 25737, 25706, 18596, 25206, 20427, 25924, 25919, 20444, 19889, 25728, 19909, 20488, 18637, 20373, 18626, 25816, 1870, 18615, 25681, 25800, 19924, 20370, 20394, 25838, 19904, 25105, 25107, 9424, 9421, 25174, 9531, 19897, 19846, 9454, 19902, 19854, 25874, 1755, 13178, 18634, 9544, 18576, 18599, 25200, 1829, 1864, 19835, 25112, 25821, 19858, 13091, 20464, 13099, 13184, 20441, 12508, 25873, 1845, 13121, 25895, 9489, 1775, 9499, 20438, 20358, 18666, 1831, 13156, 13122, 9484, 25766, 25227, 1861, 13182, 25161, 18635, 25881, 25138, 18692, 25731, 13155, 19863, 25217, 25801, 13173, 25156, 12460, 20479, 25704, 9540, 25736, 20372, 12531, 1828, 20417, 25835, 25141, 25887, 12483, 9503, 25773, 19860, 20455, 13201, 25848, 20380, 25765, 25879, 20411, 20496, 20434, 9542, 18682, 25883, 13144, 1758, 20401, 25685, 25194, 13139, 18665, 25708]
    # 4 [20944, 11004, 20939, 4190, 21023, 22966, 22839, 22933, 721, 22844, 10956, 6577, 22921, 22992, 755, 23063, 10909, 21363, 21008, 4287, 22974, 6638, 681, 23033, 6453, 11009, 6643, 21331, 782, 6666, 20987, 798, 20982, 22967, 4185, 22819, 4213, 23047, 23036, 6659, 4522, 6634, 21005, 732, 4199, 4459, 21014, 21296, 4271, 23048, 6624, 4269, 4524, 769, 6446, 4447, 6438, 20945, 11015, 750, 10924, 22929, 21421, 11023, 690, 4156, 11028, 6551, 22804, 22913, 6532, 22945, 22815, 20985, 4514, 20966, 6621, 10914, 6635, 4485, 23067, 4215, 6461, 4274, 21346, 4503, 23017, 22953, 10943, 685, 21308, 6463, 22809, 22997, 22823, 21027, 20930, 6496, 6630, 22795, 10995, 23049, 4472, 22937, 23043, 4198, 4174, 22956, 22908, 4477, 736, 6447, 10991, 6504, 10987, 22943, 22866, 22994, 20905, 21340, 10961, 4279, 21380, 717, 6623, 21347, 6566, 4528, 4456, 4520, 6522, 4283, 21383, 4264, 6450, 20983, 4448, 10966, 759, 4194, 23051, 20926, 756, 21354, 4260, 21400, 11049, 22807, 21327, 21403, 23005, 21314, 4512, 781, 21423, 22871, 22811, 6490, 790, 4234, 11011, 754, 21366, 4187, 731, 4225, 10947, 22889, 4164, 4275, 6572, 22835, 744, 4486, 21330, 4493, 6587, 11031, 4506, 23050, 23045, 6597, 22984, 6459, 10965, 4177, 11043, 6647, 6557, 10911, 6485, 22863, 6704, 786, 21351, 4239, 4211, 4540, 22886, 4233, 6528, 4535, 21427, 22961, 22977, 20962, 10998, 22903, 22813, 22991, 4509, 22939, 774, 4243, 4219, 6575, 707, 6702, 10985, 6511, 6641, 4452, 6458, 6594, 21355, 6574, 23010, 22925, 10936, 20935, 4495, 22853, 6442, 737, 6550, 728, 686, 767, 713, 22826, 23066, 6456, 10978, 6679, 4249, 718, 4265, 21311, 4455, 22868, 6580, 6498, 22942, 701, 11034, 6545, 4170, 6533, 23062, 6523, 4258, 6555, 6474, 785, 10929, 704, 22936, 22993, 6675, 22964, 22938, 20906, 10926, 710, 4208, 6632, 714, 21381, 22975, 22882, 4427, 21428, 21411, 22856, 23029, 4428, 21361, 6476, 803, 730, 4242, 6588, 4273, 4212, 4463, 6554, 21020, 4186, 6502, 21409, 22934, 4247, 6531, 4435, 4550, 4290, 4507, 22980, 4471, 6642, 20952, 4444, 4482, 715, 729, 21364, 22822, 21417, 758, 4527, 4252, 22805, 4221, 4484, 20904, 21386, 20972, 4226, 11048, 22827, 4210, 4165, 11001, 21306, 20922, 22859, 22848, 21399, 23007, 779, 21372, 10928, 21359, 10984, 22926, 6471, 6674, 4425, 4161, 6562, 6681, 6589, 21009, 22877, 760, 4498, 23024, 10990, 6606, 21422, 6500, 20961, 22874, 10904, 21295, 6658, 6591, 23012, 22931, 699, 6444, 11021, 6549, 11037, 4481, 6499, 4158, 784, 6584, 4276, 743, 10906, 10944, 4432, 6672, 4542, 4222, 11002, 21312, 22854, 6454, 709, 20900, 23061, 4189, 22840, 22941, 764, 4552, 6563, 21004, 22829, 22969, 742, 6484, 10969, 6448, 22869, 696, 20997, 21374, 22858, 6665, 6524, 22920, 21388, 4200, 21393, 22954, 11047, 20928, 10971, 22998, 22887, 20965, 20990, 4526, 4230, 4191, 23011, 6627, 23027, 20993, 6506, 4248, 6705, 726, 22981, 21415, 22881, 4220, 6662, 22850, 23055, 6677, 10953, 6520, 4254, 21389, 777, 6670, 22861, 21335, 4235, 22876, 6540, 21343, 21006, 21402, 4492, 4553, 6613, 6503, 4286, 22900, 6583, 6543, 23013, 6684, 6673, 6542, 23028, 4499, 6558, 22962, 20977, 21344, 4519, 10941, 21325, 10954, 6615, 21301, 4172, 21397, 22885, 10920, 22960, 21337, 6525, 6668, 22824, 21405, 22838, 20901, 22896, 6610, 6539, 4437, 21021, 20925, 4505, 800, 678, 20911, 20902, 10964, 22828, 780, 22958, 4171, 11033, 4510, 689, 722, 4223, 6507, 20976, 6616, 688, 22864, 4202, 4227, 4494, 21322, 795, 6488, 6629, 6617, 21357, 10977, 6654, 4431, 10907, 10997, 21362, 4508, 6626, 4532, 724, 11027, 6493, 22971, 6676, 22983, 20936, 6518, 20908, 11020, 23034, 4466, 21382, 10968, 4445, 21398, 10989, 6464, 22987, 11036, 6501, 22842, 10955, 4483, 6690, 695, 4548, 22986, 4262, 23026, 10932, 6619, 6581, 6601, 6469, 4476, 20958, 21407, 22915, 11045, 4502, 793, 21015, 4267, 711, 20917, 791, 10922, 4288, 23069, 22899, 10960, 808, 21310, 6544, 6593, 21024, 10905, 4217, 6451, 6569, 6637, 22855, 21431, 6622, 719, 22923, 21395, 10931, 10915, 4539, 21348, 20998, 20929, 23065, 22851, 11008, 20994, 22857, 23056, 20957, 6570, 22906, 6534, 804, 6660, 4529, 11000, 6494, 6656, 4440, 6646, 4424, 21416, 4237, 10975, 723, 6573, 4289, 21377, 23008, 21412, 22893, 4551, 4454, 21373, 23042, 6512, 6691, 4438, 22948, 23038, 6441, 21321, 21368, 10927, 6649, 22957, 6535, 4461, 4155, 4246, 21430, 6600, 10917, 4464, 10913, 6470, 6603, 6703, 22940, 23009, 23052, 4430, 773, 22800, 21349, 20955, 22919, 20909, 805, 4292, 10925, 6526, 11003, 20919, 20959, 6468, 4536, 6698, 10921, 20984, 6599, 697, 796, 4280, 6560, 727, 23068, 20947, 6678, 4240, 6576, 21026, 22872, 4530, 6552, 4460, 21401, 22930, 23022, 6466, 11016, 10948, 761, 22830, 10918, 23018, 10993, 6653, 22905, 4167, 10981, 11042, 4291, 4184, 6457, 22951, 10946, 23070, 4216, 20991, 6607, 21297, 687, 4183, 21356, 4465, 20916, 740, 21022, 6695, 20981, 6586, 21032, 6514, 21016, 6564, 21408, 21350, 21313, 23037, 6548, 22946, 4537, 4501, 21334, 4268, 4470, 6556, 22849, 22895, 6472, 702, 22808, 4204, 694, 11007, 23039, 21028, 11024, 789, 23025, 21029, 23019, 22988, 4229, 10970, 23004, 21019, 22816, 22797, 11039, 20950, 6602, 6567, 23040, 22870, 22909, 6482, 4193, 4154, 4434, 22901, 700, 23002, 10986, 4511, 20903, 4182, 6618, 4188, 20942, 22814, 10916, 6455, 21369, 4521, 4478, 22802, 10967, 771, 23046, 4545, 6667, 22949, 752, 21030, 20946, 6538, 6625, 20978, 21305, 22927, 23059, 6651, 21370, 21358, 6519, 738, 4544, 799, 4474, 11017, 21429, 11014, 22875, 4163, 10938, 11012, 10982, 6644, 684, 6508, 22990, 716, 10919, 21329, 4515, 22865, 6527, 792, 6592, 22818, 6605, 787, 4538, 22972, 22928, 753, 11010, 21018, 20956, 4278, 4496, 4232, 4541, 11030, 20941, 21360, 735, 4518, 6537, 6680, 691, 20964, 21300, 749, 22841, 4173, 21294, 11040, 6683, 22924, 20989, 6699, 23006, 4504, 22883, 4441, 4449, 22806, 20963, 6595, 797, 6487, 20967, 6467, 680, 21367, 10950, 6628, 4214, 21371, 748, 10952, 4549, 4241, 20960, 6694, 4480, 21003, 4517, 6689, 22898, 21375, 22860, 677, 22911, 21394, 21320, 11022, 4277, 4166, 22799, 4169, 20918, 22873, 6443, 4436, 6590, 10912, 20969, 6449, 23000, 4513, 6663, 21317, 21384, 23058, 21318, 741, 806, 21316, 6650, 783, 6693, 693, 21299, 6604, 22996, 22922, 794, 22902, 763, 23041, 11018, 6700, 4257, 22820, 708, 20974, 23060, 4251, 10973, 22878, 23021, 21424, 4245, 21298, 6620, 6483, 6491, 20913, 4270, 22907, 10974, 22852, 4157, 11013, 23054, 4256, 4236, 770, 21339, 10999, 6497, 6608, 6521, 23014, 10910, 22989, 20932, 4453, 10963, 20980, 6445, 22968, 6685, 4207, 22847, 20927, 20986, 21376, 22832, 6495, 21406, 21304, 6631, 4451, 6669, 11006, 6513, 21303, 22999, 22918, 22912, 22884, 6686, 23057, 10939, 21328, 21324, 6492, 21326, 20954, 4284, 22803, 20921, 4479, 4176, 6571, 4253, 23020, 22821, 10992, 6452, 21379, 706, 4489, 4178, 4458, 22995, 4543, 4443, 20988, 6692, 4523, 4533, 4490, 676, 21404, 20933, 22831, 4192, 4168, 22846, 11005, 6516, 22888, 4450, 22932, 21353, 22904, 20943, 22979, 22982, 22894, 6473, 22917, 6561, 21385, 10935, 6460, 6687, 22970, 6645, 4263, 11019, 712, 772, 21336, 4281, 757, 20970, 746, 10934, 11038, 10937, 6489, 4467, 4159, 6636, 6475, 4546, 6478, 4488, 21390, 10923, 21425, 10976, 4244, 739, 22910, 21414, 768, 20948, 4442, 801, 22801, 4469, 21365, 809, 10942, 4433, 22810, 20949, 4259, 21333, 4266, 10972, 6598, 6633, 6437, 6462, 4201, 4500, 21420, 21010, 6568, 11035, 21031, 6579, 23023, 4491, 6515, 22843, 6671, 4534, 4196, 22963, 22947, 4462, 4423, 6517, 4218, 10951, 22867, 6664, 679, 21012, 705, 6565, 6639, 20971, 22950, 6553, 21410, 20920, 6688, 10933, 683, 6434, 22845, 4446, 21341, 4160, 21017]



    #slices = []
    #for subj in subj_list:  # Iterate every subject
    #    slices.extend(subj_dict[subj])  # Slices for each subject

    # Load data
    subj_dataset = brats_dataset_subj(data_path, 'train', img_size, slices, use_aug=True)
    subj_loader = data.DataLoader(subj_dataset, batch_size=batch_size, shuffle=True, num_workers=3)
    print(' Number of Slices: ', subj_dataset.size)

    # Load list of validation subjects
    f = open(data_path + 'subj_t2_valid_dict.pkl', 'rb')
    val_subj_dict = pickle.load(f)
    f.close()

    #val_subj_list_all = list(val_subj_dict.keys())
    # if subj_nbr == 1:
    #    subj_list = ['Brats17_CBICA_BFB_1_t2_unbiased.nii.gz']

    #print(val_subj_list_all)

    #slices = []
    #for subj in val_subj_list_all:  # Iterate every subject
    #    slices.extend(val_subj_dict[subj])  # Slices for each subject
    slices = [25348, 25367, 25310, 25352, 25246, 25284, 25261, 25298, 25267, 25289, 25338, 25273, 25287, 25334, 25295, 25372, 25281, 25249, 25377, 25326, 25308, 25306]

    # 1 subject
        # 0 [25348, 25367, 25310, 25352, 25246, 25284, 25261, 25298, 25267, 25289, 25338, 25273, 25287, 25334, 25295, 25372, 25281, 25249, 25377, 25326, 25308, 25306]
        # 1     #   [24783, 24792, 24739, 24698, 24808, 24743, 24712, 24711, 24757, 24750, 24754, 24706, 24768, 24696, 24702, 24705, 24764, 24741, 24761, 24813, 24715]
        # 2 [10384, 10389, 10422, 10427, 10426, 10463, 10459, 10460, 10414, 10407, 10396, 10428, 10408, 10395, 10417,
        #              10457, 10441, 10462, 10377, 10435]
        # 3 [19965, 20030, 19963, 19945, 20043, 20008, 20021, 19979, 20037, 19988, 20007, 20025, 19990, 20034, 19966, 20055, 20036, 20062, 19959, 19955]
        # 4 [14600, 14593, 14605, 14693, 14583, 14580, 14636, 14602, 14581, 14612, 14651, 14705, 14664, 14566, 14606, 14610, 14640, 14660, 14643, 14639, 14630, 14586]

    # 3 subjects
        # 0 [8016, 7919, 1242, 7974, 7972, 16508, 8022, 1327, 7962, 7951, 7961, 7926, 16477, 1243, 7980, 1321, 1282, 16504, 1229, 7969, 8041, 7955, 8021, 1206, 16570, 16456, 1288, 16576, 16461, 1307, 7994, 16506, 1226, 16542, 7990, 16579, 1240, 1333, 1337, 1204, 16487, 16510, 16571, 16562, 16511, 16494, 8043, 16532, 1305, 1258, 1232, 1249, 16575, 8053, 16581, 8031, 16462, 16527, 7986, 16580, 16533, 1246, 7940]
        # 1 [16648, 11641, 17038, 16612, 11601, 16993, 11628, 17079, 17099, 11645, 17063, 16654, 11666, 11707, 11613, 11678, 11670, 16977, 16688, 16674, 17004, 16982, 11668, 17080, 11683, 17041, 17101, 17085, 16695, 17095, 11639, 16588, 16686, 16660, 17045, 16615, 11691, 17022, 16992, 11630, 16650, 17032, 16689, 11675, 11714, 17055, 16667, 16631, 16986, 11607, 16595, 11656, 17033, 16598, 16999, 17091, 17089, 11693, 17017, 11667]
        # 2 [15063, 24386, 24315, 15070, 2990, 15074, 24347, 2941, 3054, 15022, 24421, 24339, 14973, 24402, 15055, 14992, 3072, 15026, 2994, 15018, 3071, 3064, 15041, 24396, 2947, 14984, 24405, 24286, 24283, 14993, 24367, 3062, 24345, 24353, 2997, 2946, 2953, 3045, 15088, 24292, 24358, 14969, 3074, 15009, 24364, 2940, 2961, 24380, 3066, 15096, 15092, 2972, 2979, 14988, 2944, 24376, 15085, 2977, 24299, 15047, 15014, 15012]
        # 3 [553, 560, 19404, 541, 634, 10117, 648, 10159, 19458, 19474, 10149, 10186, 618, 19402, 10114, 644, 19491, 19391, 19441, 19455, 19477, 642, 19510, 19408, 620, 569, 668, 19517, 593, 10177, 10208, 19498, 19396, 10198, 599, 10178, 10199, 645, 604, 10119, 19481, 19525, 10144, 19508, 595, 649, 10161, 19487, 19457, 19524, 589, 19394, 19448, 19454, 10169, 625, 19497, 19505, 19460, 10168, 19479, 10188, 563]
        # 4 [20224, 20244, 20276, 20301, 20316, 12576, 12588, 12573, 26417, 20325, 20340, 26349, 26405, 12652, 20284, 20297, 26453, 26384, 26421, 26387, 20326, 20279, 20327, 12548, 12587, 12612, 12554, 20321, 12659, 20271, 26419, 26342, 12603, 12614, 26358, 26402, 12626, 26462, 12608, 26455, 12628, 26383, 20229, 12607, 26452, 20312, 20243, 26385, 26376, 12565, 12670, 12641, 12546, 20267, 12653, 20256, 26388, 12594, 20247, 26464, 26465, 26441, 20239]
        # 5 [13010, 12655, 12664, 12628, 12966, 13007, 12579, 12560, 1703, 1637, 12975, 13003, 12658, 12668, 13081, 1622, 12548, 13080, 12607, 12619, 1648, 13030, 1641, 12552, 13060, 1647, 1614, 13001, 12551, 12566, 12558, 1660, 13024, 12991, 1663, 1639, 1722, 12572, 12611, 12596, 1642, 1612, 1743, 12567, 1619, 13083, 1616, 12654, 1610, 13034, 1625, 13053, 13070, 1618, 12592, 12964, 12958, 12585, 12594, 12621, 1708, 12646, 12583]

    # 10 subjects
        # 0 [7256, 15684, 1954, 7302, 15771, 13896, 15730, 13318, 24269, 4551, 4455, 13829, 17853, 13871, 13759, 7241, 13308, 13830, 17770, 13802, 14945, 7273, 15654, 13864, 14930, 14856, 14899, 17857, 7296, 24187, 24220, 14964, 24239, 17893, 17213, 4518, 15748, 2012, 15738, 14949, 24153, 7288, 17159, 1894, 1962, 17831, 17107, 7333, 4483, 14872, 17861, 24257, 17835, 7272, 13832, 17231, 24207, 14879, 13211, 15756, 7271, 14918, 1904, 1945, 13777, 13320, 15721, 13885, 17876, 13753, 14877, 14967, 4499, 24150, 4520, 17771, 4539, 13882, 14911, 15720, 1896, 24180, 15705, 13848, 24151, 4497, 17804, 13240, 1912, 13300, 4453, 17887, 15664, 17186, 15753, 7336, 4524, 17105, 15780, 1968, 13209, 24161, 24217, 24266, 15693, 17131, 13764, 4461, 13881, 17227, 24251, 13243, 17852, 17175, 14902, 13815, 7342, 24233, 17794, 13326, 1878, 13778, 13287, 13304, 24244, 1880, 17142, 24247, 2014, 4514, 15691, 7315, 13250, 7247, 24254, 17167, 13863, 17869, 15746, 24204, 4473, 13754, 7373, 7351, 17878, 4451, 15671, 1980, 4471, 17769, 2003, 17886, 17190, 17176, 15677, 7345, 17148, 1908, 17127, 13796, 14886, 17865, 13813, 17121, 4532, 7370, 15742, 17152, 17888, 2001, 17129, 2004, 4529, 13235, 14922, 17164, 13321, 24184, 13839, 1950, 1955, 17867, 2007, 13332, 13245, 15676, 13823, 7343, 24194, 7285, 14901, 13774, 17198, 1998, 7316, 24189, 13886, 13819, 17801, 15673, 17815, 24268, 13847]
        # 1 [9521, 15214, 22059, 26230, 23387, 9479, 25063, 19668, 19769, 22609, 22641, 9447, 12993, 23359, 22580, 19568, 13082, 26211, 15146, 13087, 22068, 19721, 22534, 19593, 23370, 19795, 26294, 15158, 22571, 22524, 13055, 23429, 13080, 23409, 19683, 19773, 23424, 15099, 9525, 23406, 9473, 15121, 19554, 19664, 25050, 22005, 9539, 26219, 13035, 9518, 19607, 13089, 26283, 15110, 12956, 22034, 25084, 19736, 22627, 12980, 26225, 22544, 23430, 23396, 19700, 23375, 22587, 24979, 24971, 25061, 26228, 19688, 19733, 19654, 26331, 19698, 12960, 13000, 26233, 22107, 19702, 13065, 26314, 22562, 22645, 23453, 26210, 21982, 22615, 12968, 19609, 19613, 19682, 12957, 26289, 19596, 19801, 9421, 9433, 21995, 23352, 12970, 23348, 23369, 12965, 12967, 22531, 19678, 22608, 15144, 19790, 19581, 13049, 22549, 19565, 23462, 9514, 9442, 26298, 9429, 19560, 22079, 22619, 22100, 22602, 25036, 24976, 23336, 26246, 9493, 9516, 24968, 22069, 22539, 23334, 15205, 23434, 25047, 26237, 19662, 13056, 19676, 22557, 25025, 13086, 22629, 23368, 9490, 19747, 9469, 22564, 25065, 22006, 19585, 23364, 25045, 19740, 25091, 19624, 13063, 9533, 22049, 22551, 26223, 9495, 26263, 22606, 25028, 23444, 19671, 19724, 12984, 23383, 26235, 22031, 9482, 21998, 26249, 19686, 23377, 26330, 13057, 23422, 9515, 23449, 13008, 19644, 9505, 22526, 22548, 19640, 12963, 22652, 25094, 26247, 19766, 22060, 23416, 9461, 23372, 9427, 22016, 22610, 21983]
        # 2 [11088, 14470, 17084, 5550, 16339, 17058, 6639, 8410, 8436, 18497, 16984, 16407, 16364, 1388, 8376, 5612,
    #                   11187, 16322, 5506, 8367, 17068, 1433, 8349, 14460, 18476, 16379, 16329, 11102, 17036, 1410, 14437, 14423,
    #                   8358, 11059, 17018, 17052, 17102, 14469, 11098, 18492, 17071, 5512, 5545, 1420, 18501, 5505, 8405, 5546,
    #                   8340, 6663, 14527, 7161, 8325, 7128, 7220, 14462, 16975, 18519, 14452, 1437, 8411, 6642, 5598, 16372, 8355,
    #                   11180, 7205, 14526, 11167, 14442, 6656, 8323, 7214, 17087, 5618, 1387, 1390, 7195, 11066, 11184, 16432,
    #                   6644, 1375, 6626, 17002, 5585, 6684, 17101, 18511, 6695, 5503, 11186, 6589, 11054, 1382, 17063, 14523,
    #                   18435, 8394, 6634, 6686, 14553, 18433, 7172, 5501, 18430, 14539, 11130, 11142, 18512, 16366, 7208, 14519,
    #                   17089, 17010, 18427, 11053, 6674, 11112, 16388, 18487, 8398, 14448, 17026, 1402, 16448, 11163, 7185, 6685,
    #                   1462, 8409, 7141, 18530, 5523, 11103, 16401, 16416, 1374, 5553, 14500, 1356, 16355, 14473, 11058, 14457,
    #                   16367, 6705, 8415, 7196, 18539, 18426, 5608, 6585, 5599, 14483, 7139, 5569, 7152, 7132, 16380, 14550,
    #                   18515, 11124, 1470, 11121, 14508, 14439, 17054, 16357, 18505, 17045, 8360, 14562, 7116, 7178, 18441, 16385,
    #                   18489, 6667, 16989, 16418, 17042, 1371, 17035, 6611, 16334, 6654, 1460, 17079, 18534, 8320, 11131, 11132,
    #                   6653, 14461, 11165, 14488, 18495, 11170, 14478, 1471, 7167, 5541, 1458]
        # 3 [25185, 9420, 20442, 18695, 20452, 25849, 25690, 1782, 18633, 25888, 19824, 19896, 18592, 1816, 25911, 25776, 12403, 19816, 18701, 19872, 20495, 20376, 1754, 12410, 25674, 12465, 19852, 25721, 25108, 19869, 1869, 9483, 13143, 19912, 9518, 25904, 25181, 19901, 25233, 25846, 25875, 9430, 13158, 18686, 13157, 18583, 9451, 1797, 18587, 25752, 25213, 25701, 12521, 25836, 25803, 25197, 25898, 12427, 25130, 18601, 19855, 13154, 18580, 1767, 25930, 19917, 19862, 13090, 18636, 1759, 12506, 25917, 20408, 20494, 18669, 9432, 1817, 25132, 25123, 25807, 20448, 13141, 25827, 25126, 9446, 12455, 25860, 25739, 1776, 25154, 18603, 9452, 19849, 20375, 1763, 19851, 9486, 25114, 25809, 12511, 19938, 12530, 12510, 25768, 1788, 12443, 18588, 1769, 18597, 18605, 18681, 1766, 20419, 25781, 25716, 25882, 9456, 9509, 20475, 25697, 25139, 12413, 18606, 25210, 1783, 12500, 9467, 19870, 20483, 18678, 18621, 25928, 9433, 1855, 25929, 25720, 18611, 13196, 25754, 9517, 13166, 1859, 1848, 13165, 25234, 13164, 19915, 19878, 20482, 20403, 9506, 9415, 18676, 25822, 25718, 25741, 18691, 12515, 25764, 25226, 20387, 25179, 25797, 25906, 25710, 13159, 9535, 25195, 20451, 18600, 25713, 19911, 12405, 1785, 25828, 20443, 18662, 9523, 20470, 25762, 19832, 25171, 25910, 9528, 25183, 19842, 9422, 25717, 25782, 13205, 20366, 25205, 19888, 1822, 12445, 9441, 20409, 25840, 20396, 25659]
        # 4 [733, 4162, 21418, 23035, 6559, 21025, 692, 10983, 23032, 21293, 762, 6541, 6435, 10930, 21307, 20924, 4468, 10988, 4238, 20973, 6697, 6648, 22833, 11025, 22985, 21396, 747, 20995, 6652, 21392, 6436, 10945, 20999, 23064, 4497, 6640, 21413, 10940, 6480, 20915, 23015, 4422, 6596, 22880, 22837, 4261, 21352, 22892, 734, 22879, 21315, 22978, 21338, 21345, 20975, 4457, 23030, 6481, 20968, 6612, 10996, 21013, 725, 4209, 4250, 20914, 6614, 698, 10949, 20940, 4224, 22798, 6546, 21426, 20934, 4180, 23001, 6657, 20912, 11026, 4179, 4228, 22817, 23071, 6696, 22796, 22935, 23044, 23003, 21332, 4525, 6477, 10958, 745, 20937, 4473, 4255, 20979, 22959, 22916, 6439, 21419, 22891, 10980, 10959, 6547, 22952, 21001, 20992, 22862, 22973, 6479, 4426, 765, 6505, 6529, 21378, 6530, 23031, 20996, 21342, 6582, 4175, 6578, 788, 6701, 4293, 20907, 22812, 4475, 22965, 22914, 22955, 6440, 11046, 21302, 10957, 4429, 6611, 682, 4195, 807, 10962, 22825, 6661, 778, 20931, 4487, 6465, 21391, 20951, 6585, 21387, 4206, 4285, 21002, 21011, 4203, 6486, 775, 21309, 11029, 22944, 23016, 4439, 10908, 4272, 11044, 20953, 6682, 4181, 703, 6536, 20938, 6509, 776, 4516, 720, 6510, 23053, 11041, 22836, 4282, 4197, 4231, 6609, 21007, 22897, 20910, 21319, 751, 10994, 21000, 10979, 21323, 4531, 6655, 11032, 4205, 766, 20923, 22834, 4547, 22976, 802, 22890]
    # Load validation data
    val_subj_dataset = brats_dataset_subj(data_path, 'train', img_size, slices, use_aug=False)
    val_subj_loader = data.DataLoader(val_subj_dataset, batch_size=batch_size, shuffle=True, num_workers=3)
    print(' Number of Slices: ', val_subj_dataset.size)

    # Create unet
    model = UNET(model_name, 1,1,16).to(device)
    #shallow_UNet(model_name, 1,1,4).to(device)

    # Create optimizer and scheduler
    optimizer = optim.Adam(model.parameters(), lr=lr_rate)

    # Tensorboard Init
    writer_train = SummaryWriter(log_dir + model.name + '_train')
    writer_valid = SummaryWriter(log_dir + model.name + '_valid')

    # Start training
    print('Start training:')
    for epoch in range(epochs):
        print('Epoch:', epoch)

        loss = train_unet(model, subj_loader, device, optimizer)
        loss_valid = valid_unet(model, val_subj_loader, device)

        writer_train.add_scalar('Loss',loss, epoch)
        writer_train.flush()
        writer_valid.add_scalar('Loss',loss_valid, epoch)
        writer_valid.flush()

        if epoch % log_freq == 0 and not epoch == 0:
            data_path = log_model + model_name + str(epoch) + '.pth'
            torch.save(model, data_path)