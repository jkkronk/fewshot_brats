 Vae model:  camcan_400_Aug_2_100  NN model:  app5_2_1000_5_2_10_200
Using device: cuda:0
Loading train set for subj
0.27539045396870393 9.216414552133848e-09
0.2883534374622517 4.156384590188306e-07
0.2684035720181986 2.8414255744680163e-07
0.280838418540296 4.214672251503205e-07
0.28189236628082043 2.3385025044824587e-07
Fpr:  0.06737440087455727
Best Threshold=0.034660, G-Mean=0.874
AUC training :  0.9332557076379411
Dice training:  0.3671599522447733
0.03466034482748343
0.0
Loading test set for subj
Subject  Brats17_CBICA_AMH_1_t2_unbiased.nii.gz  Number of Slices:  140
AUC :  0.9643738315313953
DCS:  0.6751191439618739
0.02
Loading test set for subj
Subject  Brats17_TCIA_645_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.9247971950585445
DCS:  0.17862481315396114
0.04
Loading test set for subj
Subject  Brats17_2013_3_1_t2_unbiased.nii.gz  Number of Slices:  128
AUC :  0.9297296824090113
DCS:  0.4199070592788127
0.06
Loading test set for subj
Subject  Brats17_TCIA_331_1_t2_unbiased.nii.gz  Number of Slices:  123
AUC :  0.9787983132103422
DCS:  0.48559584855835664
0.08
Loading test set for subj
Subject  Brats17_TCIA_147_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.9553195432172512
DCS:  0.46344224158883374
0.1
Loading test set for subj
Subject  Brats17_TCIA_261_1_t2_unbiased.nii.gz  Number of Slices:  125
AUC :  0.7596583649120512
DCS:  0.4423621223474192
0.12
Loading test set for subj
Subject  Brats17_TCIA_410_1_t2_unbiased.nii.gz  Number of Slices:  129
AUC :  0.645430580771278
DCS:  0.33049780644803173
0.14
Loading test set for subj
Subject  Brats17_CBICA_ALX_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.9313803306702872
DCS:  0.45915641149954095
0.16
Loading test set for subj
Subject  Brats17_TCIA_390_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.905051146002693
DCS:  0.5716742684830209
0.18
Loading test set for subj
Subject  Brats17_TCIA_653_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.9701067590072916
DCS:  0.44448645312665064
0.2
Loading test set for subj
Subject  Brats17_CBICA_AOP_1_t2_unbiased.nii.gz  Number of Slices:  146
AUC :  0.698208298483848
DCS:  0.1770900126818564
0.22
Loading test set for subj
Subject  Brats17_CBICA_AWH_1_t2_unbiased.nii.gz  Number of Slices:  130
AUC :  0.9141036576045006
DCS:  0.48806296816915795
0.24
Loading test set for subj
Subject  Brats17_TCIA_449_1_t2_unbiased.nii.gz  Number of Slices:  131
AUC :  0.9060898304832686
DCS:  0.20834999106170674
0.26
Loading test set for subj
Subject  Brats17_TCIA_460_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.9168869199624297
DCS:  0.5248862384672942
0.28
Loading test set for subj
Subject  Brats17_TCIA_401_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.935979933443941
DCS:  0.6315210140093396
0.3
Loading test set for subj
Subject  Brats17_TCIA_634_1_t2_unbiased.nii.gz  Number of Slices:  139
AUC :  0.904079589999949
DCS:  0.39235901303918425
0.32
Loading test set for subj
Subject  Brats17_TCIA_615_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.9054722738396324
DCS:  0.19520009047603262
0.34
Loading test set for subj
Subject  Brats17_TCIA_242_1_t2_unbiased.nii.gz  Number of Slices:  127
AUC :  0.9584553012837149
DCS:  0.6188248539317118
0.36
Loading test set for subj
Subject  Brats17_TCIA_179_1_t2_unbiased.nii.gz  Number of Slices:  131
AUC :  0.9198577970777875
DCS:  0.38059844834353573
0.38
Loading test set for subj
Subject  Brats17_TCIA_298_1_t2_unbiased.nii.gz  Number of Slices:  132
AUC :  0.9868027102292105
DCS:  0.4945153720289356
0.4
Loading test set for subj
Subject  Brats17_TCIA_199_1_t2_unbiased.nii.gz  Number of Slices:  139
AUC :  0.9665382600117891
DCS:  0.7475107459600631
0.42
Loading test set for subj
Subject  Brats17_2013_18_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.9557514647270327
DCS:  0.548131437023346
0.44
Loading test set for subj
Subject  Brats17_TCIA_168_1_t2_unbiased.nii.gz  Number of Slices:  144
AUC :  0.9438831286476803
DCS:  0.3203008172351793
0.46
Loading test set for subj
Subject  Brats17_TCIA_103_1_t2_unbiased.nii.gz  Number of Slices:  128
AUC :  0.7875673490394159
DCS:  0.44050772626931567
0.48
Loading test set for subj
Subject  Brats17_TCIA_346_1_t2_unbiased.nii.gz  Number of Slices:  140
AUC :  0.9702749377813391
DCS:  0.6555194277997141
0.5
Loading test set for subj
Subject  Brats17_TCIA_470_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.7850265350449025
DCS:  0.14470412729985083
0.52
Loading test set for subj
Subject  Brats17_CBICA_AXJ_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.9813656196188458
DCS:  0.55662980506168
0.54
Loading test set for subj
Subject  Brats17_2013_15_1_t2_unbiased.nii.gz  Number of Slices:  129
AUC :  0.9593551111465486
DCS:  0.10508138130159955
0.56
Loading test set for subj
Subject  Brats17_TCIA_491_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.8763109057416227
DCS:  0.34418255282939103
0.58
Loading test set for subj
Subject  Brats17_2013_29_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.9528756319928996
DCS:  0.37246421686626646
0.6
Loading test set for subj
Subject  Brats17_CBICA_AQG_1_t2_unbiased.nii.gz  Number of Slices:  140
AUC :  0.8727495096343008
DCS:  0.46226029927352613
0.62
Loading test set for subj
Subject  Brats17_2013_0_1_t2_unbiased.nii.gz  Number of Slices:  127
AUC :  0.9447706840223421
DCS:  0.20528856422743388
0.64
Loading test set for subj
Subject  Brats17_TCIA_205_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.8887551598035093
DCS:  0.4380381041280104
0.66
Loading test set for subj
Subject  Brats17_TCIA_177_1_t2_unbiased.nii.gz  Number of Slices:  124
AUC :  0.8283421449927246
DCS:  0.15705618435811156
0.68
Loading test set for subj
Subject  Brats17_TCIA_413_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.8180075963560058
DCS:  0.22437955709806254
0.7
Loading test set for subj
Subject  Brats17_CBICA_ASU_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.8699403652385693
DCS:  0.5165614565307466
0.72
Loading test set for subj
Subject  Brats17_TCIA_630_1_t2_unbiased.nii.gz  Number of Slices:  133
AUC :  0.9622883809128815
DCS:  0.541425068182339
0.74
Loading test set for subj
Subject  Brats17_CBICA_ABO_1_t2_unbiased.nii.gz  Number of Slices:  144
AUC :  0.7698887231420268
DCS:  0.44340645645791454
0.76
Loading test set for subj
Subject  Brats17_2013_13_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.9296896689933453
DCS:  0.10777181174216642
0.78
Loading test set for subj
Subject  Brats17_TCIA_607_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.9332885593437735
DCS:  0.39130604440629024
0.8
Loading test set for subj
Subject  Brats17_TCIA_402_1_t2_unbiased.nii.gz  Number of Slices:  142
AUC :  0.9803554508738817
DCS:  0.5740409358614081
0.82
Loading test set for subj
Subject  Brats17_TCIA_131_1_t2_unbiased.nii.gz  Number of Slices:  130
AUC :  0.9307770278523049
DCS:  0.2099381094438755
0.84
Loading test set for subj
Subject  Brats17_TCIA_374_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.9084752177716232
DCS:  0.26329155552307526
0.86
Loading test set for subj
Subject  Brats17_TCIA_603_1_t2_unbiased.nii.gz  Number of Slices:  147
AUC :  0.87505832951655
DCS:  0.558571508317517
0.88
Loading test set for subj
Subject  Brats17_TCIA_101_1_t2_unbiased.nii.gz  Number of Slices:  135
AUC :  0.7511897883898164
DCS:  0.14390019478269184
0.9
Loading test set for subj
Subject  Brats17_TCIA_448_1_t2_unbiased.nii.gz  Number of Slices:  127
AUC :  0.8685236993861033
DCS:  0.4015339254381998
0.92
Loading test set for subj
Subject  Brats17_TCIA_621_1_t2_unbiased.nii.gz  Number of Slices:  145
AUC :  0.963517725885553
DCS:  0.31363356183573976
0.94
Loading test set for subj
Subject  Brats17_TCIA_234_1_t2_unbiased.nii.gz  Number of Slices:  133
AUC :  0.9868921273337112
DCS:  0.6516244020564382
0.96
Loading test set for subj
Subject  Brats17_TCIA_130_1_t2_unbiased.nii.gz  Number of Slices:  130
AUC :  0.937588439771502
DCS:  0.3584438886472379
0.98
Loading test set for subj
Subject  Brats17_CBICA_AME_1_t2_unbiased.nii.gz  Number of Slices:  144
AUC :  0.9442942933044403
DCS:  0.48441797271704223
Mean All AUC:  0.9030784779095093
Std ALL AUC:  0.07709467266043071
Mean All DCS:  0.40528392018658976
Std ALL DCS:  0.16402751194362894
 Vae model:  camcan_400_Aug_2_100  NN model:  app5_2_100_4_2_10_200
Using device: cuda:0
Loading train set for subj
Traceback (most recent call last):
  File "restore_MAP_NN.py", line 79, in <module>
    device, riter, step_rate)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/utils/threshold.py", line 376, in compute_threshold_subj
    step_size=step_size, log=False)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/restoration.py", line 68, in run_map_NN
    __, z_mean, z_cov, __ = vae_model(img_ano.unsqueeze(1).double())
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/models/vae.py", line 53, in forward
    mu, logvar, res = self.encode(x)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/models/vae.py", line 35, in encode
    res = self.res_encoder(x)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/container.py", line 100, in forward
    input = module(input)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/container.py", line 100, in forward
    input = module(input)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/activation.py", line 559, in forward
    return F.leaky_relu(input, self.negative_slope, self.inplace)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/functional.py", line 1063, in leaky_relu
    result = torch._C._nn.leaky_relu(input, negative_slope)
RuntimeError: CUDA out of memory. Tried to allocate 128.00 MiB (GPU 0; 11.93 GiB total capacity; 11.39 GiB already allocated; 81.25 MiB free; 11.41 GiB reserved in total by PyTorch)
 Vae model:  camcan_400_Aug_2_100  NN model:  app5_2_10000_5_2_10_200
Using device: cuda:0
Loading train set for subj
Traceback (most recent call last):
  File "restore_MAP_NN.py", line 79, in <module>
    device, riter, step_rate)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/utils/threshold.py", line 376, in compute_threshold_subj
    step_size=step_size, log=False)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/restoration.py", line 68, in run_map_NN
    __, z_mean, z_cov, __ = vae_model(img_ano.unsqueeze(1).double())
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/models/vae.py", line 53, in forward
    mu, logvar, res = self.encode(x)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/models/vae.py", line 35, in encode
    res = self.res_encoder(x)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/container.py", line 100, in forward
    input = module(input)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/container.py", line 100, in forward
    input = module(input)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/activation.py", line 559, in forward
    return F.leaky_relu(input, self.negative_slope, self.inplace)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/functional.py", line 1063, in leaky_relu
    result = torch._C._nn.leaky_relu(input, negative_slope)
RuntimeError: CUDA out of memory. Tried to allocate 128.00 MiB (GPU 0; 11.93 GiB total capacity; 11.39 GiB already allocated; 81.25 MiB free; 11.41 GiB reserved in total by PyTorch)
 Vae model:  camcan_400_Aug_2_100  NN model:  app5_2_10000_4_2_10_100
Using device: cuda:0
Traceback (most recent call last):
  File "restore_MAP_NN.py", line 68, in <module>
    net = torch.load(path, map_location=torch.device(device))
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py", line 525, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py", line 212, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py", line 193, in __init__
    super(_open_file, self).__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: '/scratch_net/biwidl214/jonatank/logs/restore/app5_2_10000_4_2_10_100.pth'
