 Vae model:  camcan_400_Aug_2_100  NN model:  train_1subj_app1_1250
Using device: cuda:0
Loading train set for subj
0.4690587155371549 0.000611384972986434
0.4605110508373605 0.0003929259214823445
0.45635037867032224 0.0003920308493197838
0.41704006029476315 0.0005693740426459583
0.4295601987381528 0.001056450586518804
Loading train set for subj
0.4760182639346341 0.0004303181523903876
0.47512241650746734 0.0008373485868739012
0.47970400858970635 0.00029132184231616564
0.4657108733119994 0.0002546098557659961
0.36849366462670674 0.0002550784303721231
Loading train set for subj
0.3780074150580692 0.0004005792835299668
0.42548259715690073 0.0005546761383616543
0.42878303688975006 0.00038132718645207827
0.4143232760120113 0.0005152372501485466
0.33971941788245724 0.0008573615369587514
Loading train set for subj
0.43905419327846673 0.0005329457918087635
0.4515635964057678 0.0004888570211973904
0.46274811027805307 0.00027894803015172926
0.4637479206028562 0.00037566805495508357
0.43462090672477466 0.0004967454120329705
Best Threshold=0.167177, G-Mean=0.772
AUC training :  0.7408697919977588
0.1671765890263807
0.0
Loading test set for subj
Subject  Brats17_CBICA_AMH_1_t2_unbiased.nii.gz  Number of Slices:  140
AUC :  0.9713633299042911
DCS:  0.48280144584455276
0.02
Loading test set for subj
Subject  Brats17_TCIA_645_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.9263472288449055
DCS:  0.11252331644994076
0.04
Loading test set for subj
Subject  Brats17_2013_3_1_t2_unbiased.nii.gz  Number of Slices:  128
AUC :  0.9061300606972881
DCS:  0.46401686810040466
0.06
Loading test set for subj
Subject  Brats17_TCIA_331_1_t2_unbiased.nii.gz  Number of Slices:  123
AUC :  0.8653772824857024
DCS:  0.15824088377100595
0.08
Loading test set for subj
Subject  Brats17_TCIA_147_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.8867779886997296
DCS:  0.43457868064848737
0.1
Loading test set for subj
Subject  Brats17_TCIA_261_1_t2_unbiased.nii.gz  Number of Slices:  125
AUC :  0.8105465275570599
DCS:  0.31389899810952443
0.12
Loading test set for subj
Subject  Brats17_TCIA_410_1_t2_unbiased.nii.gz  Number of Slices:  129
AUC :  0.7275459847192064
DCS:  0.24173715751313227
0.14
Loading test set for subj
Subject  Brats17_CBICA_ALX_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.7344546948787086
DCS:  0.20214003590664273
0.16
Loading test set for subj
Subject  Brats17_TCIA_390_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.7484367342743163
DCS:  0.5171458261170766
0.18
Loading test set for subj
Subject  Brats17_TCIA_653_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.7569164119627423
DCS:  0.31128841639170685
0.2
Loading test set for subj
Subject  Brats17_CBICA_AOP_1_t2_unbiased.nii.gz  Number of Slices:  146
AUC :  0.7576145693138477
DCS:  0.13854092377396485
0.22
Loading test set for subj
Subject  Brats17_CBICA_AWH_1_t2_unbiased.nii.gz  Number of Slices:  130
AUC :  0.7603135539990412
DCS:  0.3592918049401919
0.24
Loading test set for subj
Subject  Brats17_TCIA_449_1_t2_unbiased.nii.gz  Number of Slices:  131
AUC :  0.7592477580330544
DCS:  0.18866394572532907
0.26
Loading test set for subj
Subject  Brats17_TCIA_460_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.7708490836587772
DCS:  0.5186280345359472
0.28
Loading test set for subj
Subject  Brats17_TCIA_401_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.7882033153974656
DCS:  0.5944131860475479
0.3
Loading test set for subj
Subject  Brats17_TCIA_634_1_t2_unbiased.nii.gz  Number of Slices:  139
AUC :  0.7974466937531164
DCS:  0.44248493637353387
0.32
Loading test set for subj
Subject  Brats17_TCIA_615_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.79029699270863
DCS:  0.1752973261620372
0.34
Loading test set for subj
Subject  Brats17_TCIA_242_1_t2_unbiased.nii.gz  Number of Slices:  127
AUC :  0.7974222035625428
DCS:  0.4745875687385436
0.36
Loading test set for subj
Subject  Brats17_TCIA_179_1_t2_unbiased.nii.gz  Number of Slices:  131
AUC :  0.7999638008437948
DCS:  0.32644969049024936
0.38
Loading test set for subj
Subject  Brats17_TCIA_298_1_t2_unbiased.nii.gz  Number of Slices:  132
AUC :  0.8096358367066437
DCS:  0.5917390267097613
0.4
Loading test set for subj
Subject  Brats17_TCIA_199_1_t2_unbiased.nii.gz  Number of Slices:  139
AUC :  0.8165542858874709
DCS:  0.6206483434923121
0.42
Loading test set for subj
Subject  Brats17_2013_18_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.8167377304825738
DCS:  0.4743861861052717
0.44
Loading test set for subj
Subject  Brats17_TCIA_168_1_t2_unbiased.nii.gz  Number of Slices:  144
AUC :  0.8222607449858902
DCS:  0.33156690182384446
0.46
Loading test set for subj
Subject  Brats17_TCIA_103_1_t2_unbiased.nii.gz  Number of Slices:  128
Traceback (most recent call last):
  File "restore_MAP_NN.py", line 163, in <module>
    AUC = roc_auc_score(y_true, y_pred)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/sklearn/metrics/_ranking.py", line 390, in roc_auc_score
    sample_weight=sample_weight)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/sklearn/metrics/_base.py", line 77, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/sklearn/metrics/_ranking.py", line 225, in _binary_roc_auc_score
    sample_weight=sample_weight)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/sklearn/metrics/_ranking.py", line 771, in roc_curve
    y_true, y_score, pos_label=pos_label, sample_weight=sample_weight)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/sklearn/metrics/_ranking.py", line 593, in _binary_clf_curve
    fps = 1 + threshold_idxs - tps
MemoryError: Unable to allocate array with shape (37899155,) and data type float64
