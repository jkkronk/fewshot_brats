Name:  1subj_3lr_20steps_1000K_2fch_BCE_10_ Lr_rate:  0.001 Use Teacher:  False  Riter:  20  Subjs:  1
Using device: cuda:0
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'networks.vae_bilinear_conv.ResBlock_Down' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'networks.vae_bilinear_conv.ResBlock_Up' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
['Brats17_CBICA_BHK_1_t2_unbiased.nii.gz']
Loading train set for subj
Subject  Brats17_CBICA_BHK_1_t2_unbiased.nii.gz  Number of Slices:  146
AUC :  0.3121170208298123
AUC :  0.30501358527209627
AUC :  0.29037027138240623
AUC :  0.37399354642455246
AUC :  0.38423867951540114
AUC :  0.448994015382335
AUC :  0.38389590021436176
AUC :  0.48579994185591957
AUC :  0.3144977333893564
AUC :  0.45759988573964316
AUC :  0.41879025834215283
AUC :  0.41532839016017087
AUC :  0.3560170715470096
AUC :  0.3518564676251531
AUC :  0.3178173972247201
AUC :  0.38086154291957275
AUC :  0.33575024728799296
AUC :  0.28438735455641906
AUC :  0.3739599009130371
AUC :  0.3901408412480258
AUC :  0.38208923060671135
AUC :  0.371665912836063
AUC :  0.3929888184356832
AUC :  0.4682234551648921
AUC :  0.3643778586758102
AUC :  0.29206355760780733
AUC :  0.38389029698236843
AUC :  0.4400620121923875
AUC :  0.5256269891837818
AUC :  0.3517162527395027
AUC :  0.3016960078597776
AUC :  0.30379390713192367
AUC :  0.3421750531838569
AUC :  0.3426048420478723
AUC :  0.3673311349679038
AUC :  0.2666588220445316
AUC :  0.40643297757130303
AUC :  0.3895231044318026
AUC :  0.5192257010621135
AUC :  0.4246394232373073
AUC :  0.40657358138379573
AUC :  0.4297585016684057
AUC :  0.42402454357594765
AUC :  0.4308118778687977
AUC :  0.38932890825570987
AUC :  0.35895570534977694
AUC :  0.40392354146739384
AUC :  0.32065257604655106
AUC :  0.29745783468123377
AUC :  0.26590436600415407
AUC :  0.32828710314431275
AUC :  0.39976344809326425
AUC :  0.3303650134212743
AUC :  0.31551831135171404
AUC :  0.3894670594263084
AUC :  0.44068698995216526
AUC :  0.4258960474310498
AUC :  0.40373159573132555
AUC :  0.3547547067548888
AUC :  0.2912819315419965
AUC :  0.36826659668384265
AUC :  0.397204230941943
AUC :  0.4892062916053131
AUC :  0.5101729934085983
AUC :  0.5007038493298348
AUC :  0.5390421042527179
AUC :  0.5201842683840242
AUC :  0.5314530196618368
AUC :  0.5139804285875981
AUC :  0.38494753075897326
AUC :  0.4048259991527865
AUC :  0.3265524875632245
AUC :  0.4872173322022537
AUC :  0.41741500809348975
AUC :  0.45273918627566023
AUC :  0.4423939555202609
AUC :  0.5047983532796115
AUC :  0.29630271930143676
AUC :  0.43715282649457254
AUC :  0.46863815240277373
AUC :  0.3232215053130325
AUC :  0.4972420993613994
AUC :  0.46889262810912025
AUC :  0.5020321245115342
AUC :  0.4838699703921058
AUC :  0.4608567632062941
AUC :  0.5121065264826361
AUC :  0.3533399658228593
AUC :  0.36586315897419197
AUC :  0.542381680870291
AUC :  0.4141462455724868
AUC :  0.40804669224526485
AUC :  0.41906998449278066
AUC :  0.4641996480156267
AUC :  0.5369500964088209
AUC :  0.5201404431873331
AUC :  0.3979111106800565
AUC :  0.3918931986466004
AUC :  0.45344101527041003
AUC :  0.41940597906788907
AUC :  0.4642495042133232
AUC :  0.5971767175812454
AUC :  0.4560972603683527
AUC :  0.4569163527322845
AUC :  0.477222615839449
AUC :  0.509525334146121
AUC :  0.5241427576824659
AUC :  0.5116385816386582
AUC :  0.5806002584442262
AUC :  0.5714353595935485
AUC :  0.5615572336412277
AUC :  0.4010324222853903
AUC :  0.430862987961247
AUC :  0.43544508283695993
AUC :  0.438980305377908
AUC :  0.4593385556347662
AUC :  0.522811344427256
AUC :  0.4649471704154644
AUC :  0.4381564784982832
AUC :  0.5714651879391536
AUC :  0.405095514265676
AUC :  0.43662020793868955
AUC :  0.4339538579164454
AUC :  0.5067617747823202
AUC :  0.5022390979867379
AUC :  0.4821411686027635
AUC :  0.4864763550535999
AUC :  0.4831688641524398
AUC :  0.5000150270121928
AUC :  0.43716357282255935
AUC :  0.48998846576991917
AUC :  0.6701539939804795
AUC :  0.5407018507374347
AUC :  0.5751237718558281
AUC :  0.4420962450338344
AUC :  0.5180800411495885
AUC :  0.47213295482592993
AUC :  0.43452455374692556
AUC :  0.502142989808493
AUC :  0.5677786300911472
AUC :  0.6293051908169365
AUC :  0.49966866512962754
AUC :  0.4347765835017704
AUC :  0.43012177761452225
AUC :  0.5613823067528676
AUC :  0.567612940227677
AUC :  0.5792534130323909
AUC :  0.5178617760621393
AUC :  0.527370896850003
AUC :  0.45380870974184595
AUC :  0.4325364434045541
AUC :  0.45251361445652805
AUC :  0.4502072072219154
AUC :  0.5578003904699147
AUC :  0.5139261194639941
AUC :  0.4519462069088862
AUC :  0.5661577817429273
AUC :  0.5270914398759385
AUC :  0.46916246592997274
AUC :  0.47903884561216137
AUC :  0.4420063868209456
AUC :  0.37354326225242146
AUC :  0.6244290979363258
AUC :  0.6079017864949835
AUC :  0.49826350670800823
AUC :  0.40926758786002226
AUC :  0.43315871243105913
AUC :  0.4319863881754604
AUC :  0.6077988914742167
AUC :  0.5769705564396468
AUC :  0.6084211743591654
AUC :  0.6292077488551164
AUC :  0.6035403662455289
AUC :  0.5477733240804021
AUC :  0.49986366298609475
AUC :  0.5671329022009427
AUC :  0.450412713261068
AUC :  0.45463442103562135
AUC :  0.49921258371483046
AUC :  0.4447891155188071
AUC :  0.541549055988124
AUC :  0.5321374116442593
AUC :  0.5337206827378045
AUC :  0.5260469625463613
AUC :  0.5811336850981685
AUC :  0.4731274637497566
AUC :  0.5900015447111537
AUC :  0.5857025381520788
AUC :  0.5583949110353509
AUC :  0.5565227301423479
AUC :  0.547508655520377
AUC :  0.5538421440058037
AUC :  0.582740234114788
AUC :  0.6412962141192676
AUC :  0.5941804813613261
AUC :  0.6600310552381684
AUC :  0.6028561784107458
AUC :  0.6326814112432251
AUC :  0.5966080773779331
AUC :  0.565556521264645
AUC :  0.6735361487926468
AUC :  0.4546038090749097
AUC :  0.5931265086846744
AUC :  0.5881091362626203
AUC :  0.4817110371684669
AUC :  0.5785911244398515
AUC :  0.49252857249240206
AUC :  0.6249368923874401
AUC :  0.6879159935892362
AUC :  0.65745655904821
AUC :  0.7098149274392904
AUC :  0.7396294001227626
AUC :  0.738419744839118
AUC :  0.7654158101995817
AUC :  0.784966820531971
AUC :  0.6589122530913281
AUC :  0.38049973818235766
AUC :  0.4638531219507973
AUC :  0.5068586533160274
AUC :  0.5261133873337048
AUC :  0.474429283627847
AUC :  0.4231949287367863
AUC :  0.5162099700699803
AUC :  0.5089569311333049
AUC :  0.647396381707183
AUC :  0.5629204564741063
AUC :  0.6063113081203834
AUC :  0.5362065190737203
AUC :  0.5586448794608866
AUC :  0.6106005346553465
AUC :  0.5305409605540123
AUC :  0.7361429474943926
AUC :  0.7035952631027715
AUC :  0.5869552608237179
AUC :  0.753326369473766
AUC :  0.6745784420971157
AUC :  0.6576486179893214
AUC :  0.6218983815088894
AUC :  0.5570556558870607
AUC :  0.7153479943539779
AUC :  0.6670519060279247
AUC :  0.663834276919326
AUC :  0.5473586742244982
AUC :  0.6037002868700511
AUC :  0.6330578920909233
AUC :  0.5503970902703034
AUC :  0.4469786820464216
AUC :  0.4758276892706489
AUC :  0.5480657071475544
AUC :  0.7012787623502661
AUC :  0.6372054234421172
AUC :  0.6541252463797729
AUC :  0.434075296937867
AUC :  0.5718202434559476
AUC :  0.5307103780565303
AUC :  0.5309004271884866
AUC :  0.6657119418432078
AUC :  0.37112862695366705
AUC :  0.6000300693650129
AUC :  0.643281775029529
AUC :  0.5809747804342136
AUC :  0.6739615897558506
Traceback (most recent call last):
  File "train_restore_MAP_NN.py", line 123, in <module>
    device, writer, seg, mask)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/restoration.py", line 134, in train_run_map_NN
 