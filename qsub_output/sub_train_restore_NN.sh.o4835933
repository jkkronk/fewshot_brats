Name:  train_1subj_app4_CNN_2 Lr_rate:  0.0001 Use Teacher:  False  Riter:  100  Subjs:  2
Using device: cuda:0
['Brats17_CBICA_AQZ_1_t2_unbiased.nii.gz']
validation subject ['Brats17_TCIA_409_1_t2_unbiased.nii.gz']
Loading train set for subj
Subject  Brats17_CBICA_AQZ_1_t2_unbiased.nii.gz  Number of Slices:  138
0
Traceback (most recent call last):
  File "train_restore_MAP_NN.py", line 156, in <module>
    optimizer, 0.01)#step_rate)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/restoration.py", line 163, in train_run_map_NN_4
    loss.backward()
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/tensor.py", line 195, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/autograd/__init__.py", line 99, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: element 0 of tensors does not require grad and does not have a grad_fn
