[Brats17_TCIA_141_1_t2_unbiased.nii.gz]
 Vae model:  camcan_400_Aug_6_100  NN model:  1subj_1e1_10steps_2fch3sh_DCS_1_100
Using device: cuda:0
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'networks.vae_bilinear_conv.ResBlock_Down' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'networks.vae_bilinear_conv.ResBlock_Up' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
Loading train set for subj
0.0 : 0.19417430254085408
0.01 : 0.2987251683943963
0.02 : 0.40540526980357394
0.03 : 0.4429160813831244
0.04 : 0.4476615481921361
0.05 : 0.4340888520377485
0.06 : 0.40711024041716487
0.07 : 0.3750089956101423
0.08 : 0.34018465501187817
0.09 : 0.30422083820508405
0.1 : 0.2694043476763014
0.11 : 0.23598880750555512
0.12 : 0.20657722268992637
0.13 : 0.17925702535983548
0.14 : 0.15586863943173596
0.15 : 0.13614342192463263
0.16 : 0.1196636706291679
0.17 : 0.1034640837868654
0.18 : 0.0896714898878809
0.19 : 0.07746948235590809
0.2 : 0.06646924525673867
0.21 : 0.05644373932145472
0.22 : 0.04817886588128403
0.23 : 0.03995430265229876
0.24 : 0.0327754922218706
0.25 : 0.0263241535326341
0.26 : 0.020096729588867962
0.27 : 0.014429144611675175
0.28 : 0.009635670875712442
0.29 : 0.006236822503061598
0.3 : 0.00389513487536833
0.31 : 0.0022665687441436426
0.32 : 0.0012166683564838285
0.33 : 0.0005452977579385208
0.34 : 0.00030444682645896625
0.35 : 0.0001268882558574791
0.36 : 6.345499771562007e-05
0.37 : 1.269269091393721e-05
0.38 : 0.0
0.39 : 0.0
0.4 : 0.0
0.41 : 0.0
0.42 : 0.0
0.43 : 0.0
AUC training :  0.835136866179248  - Dice training :  0.4476615481921361
0.04
0.0
Loading test set for subj
Subject  Brats17_CBICA_AMH_1_t2_unbiased.nii.gz  Number of Slices:  140
AUC :  0.7185382703689657
DCS:  0.26455648826391487
0.02
Loading test set for subj
Subject  Brats17_TCIA_645_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.6847870055933457
DCS:  0.10567104367008133
0.04
Loading test set for subj
Subject  Brats17_2013_3_1_t2_unbiased.nii.gz  Number of Slices:  128
AUC :  0.6585709753355037
DCS:  0.10790961457462019
0.06
Loading test set for subj
Subject  Brats17_TCIA_331_1_t2_unbiased.nii.gz  Number of Slices:  123
AUC :  0.6511157384536295
DCS:  0.040460232507437285
0.08
Loading test set for subj
Subject  Brats17_TCIA_147_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.6711807572023679
DCS:  0.28512043157627415
0.1
Loading test set for subj
Subject  Brats17_TCIA_261_1_t2_unbiased.nii.gz  Number of Slices:  125
AUC :  0.6698876983973274
DCS:  0.3344623433842765
0.12
Loading test set for subj
Subject  Brats17_TCIA_410_1_t2_unbiased.nii.gz  Number of Slices:  129
AUC :  0.6655682707414291
DCS:  0.3101763622005791
0.14
Loading test set for subj
Subject  Brats17_CBICA_ALX_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.6593757421771022
DCS:  0.0703630605406894
0.16
Loading test set for subj
Subject  Brats17_TCIA_390_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.6535262658487581
DCS:  0.14216810740329358
0.18
Loading test set for subj
Subject  Brats17_TCIA_653_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.6648646641865565
DCS:  0.21986024887948555
0.2
Loading test set for subj
Subject  Brats17_CBICA_AOP_1_t2_unbiased.nii.gz  Number of Slices:  146
AUC :  0.6496943799222009
DCS:  0.037845153276396544
0.22
Loading test set for subj
Subject  Brats17_CBICA_AWH_1_t2_unbiased.nii.gz  Number of Slices:  130
AUC :  0.6544894796497035
DCS:  0.27200387489620814
0.24
Loading test set for subj
Subject  Brats17_TCIA_449_1_t2_unbiased.nii.gz  Number of Slices:  131
AUC :  0.6551253789983179
DCS:  0.08383304461126165
0.26
Loading test set for subj
Subject  Brats17_TCIA_460_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.6592295958650811
DCS:  0.27915644746221413
0.28
Loading test set for subj
Subject  Brats17_TCIA_401_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.6600138716183346
DCS:  0.2846250126856331
0.3
Loading test set for subj
Subject  Brats17_TCIA_634_1_t2_unbiased.nii.gz  Number of Slices:  139
AUC :  0.6680075541894622
DCS:  0.3494391999354224
0.32
Loading test set for subj
Subject  Brats17_TCIA_615_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.6669218401032938
DCS:  0.1861963267677746
0.34
Loading test set for subj
Subject  Brats17_TCIA_242_1_t2_unbiased.nii.gz  Number of Slices:  127
AUC :  0.6676668287646074
DCS:  0.2234345993578252
0.36
Loading test set for subj
Subject  Brats17_TCIA_179_1_t2_unbiased.nii.gz  Number of Slices:  131
AUC :  0.666176865459485
DCS:  0.06562813028910919
0.38
Loading test set for subj
Subject  Brats17_TCIA_298_1_t2_unbiased.nii.gz  Number of Slices:  132
AUC :  0.6768566550979356
DCS:  0.4546024765147644
0.4
Loading test set for subj
Subject  Brats17_TCIA_199_1_t2_unbiased.nii.gz  Number of Slices:  139
AUC :  0.691966457339782
DCS:  0.5451927477001247
0.42
Loading test set for subj
Subject  Brats17_2013_18_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.6917384888077861
DCS:  0.26241732636728077
0.44
Loading test set for subj
Subject  Brats17_TCIA_168_1_t2_unbiased.nii.gz  Number of Slices:  144
AUC :  0.7010912958351588
DCS:  0.42009568801610997
0.46
Loading test set for subj
Subject  Brats17_TCIA_103_1_t2_unbiased.nii.gz  Number of Slices:  128
AUC :  0.7004054625786763
DCS:  0.3493205956108523
0.48
Loading test set for subj
Subject  Brats17_TCIA_346_1_t2_unbiased.nii.gz  Number of Slices:  140
AUC :  0.7025767494123959
DCS:  0.24113364858138378
0.5
Loading test set for subj
Subject  Brats17_TCIA_470_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.6998257432256053
DCS:  0.016488137008705134
0.52
Loading test set for subj
Subject  Brats17_CBICA_AXJ_1_t2_unbiased.nii.gz  Number of Slices:  138
AUC :  0.7095697758979926
DCS:  0.5197370278588013
0.54
Loading test set for subj
Subject  Brats17_2013_15_1_t2_unbiased.nii.gz  Number of Slices:  129
AUC :  0.7113275757588808
DCS:  0.18699647370724048
0.56
Loading test set for subj
Subject  Brats17_TCIA_491_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.7091503849598345
DCS:  0.24606782602286775
0.58
Loading test set for subj
Subject  Brats17_2013_29_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.7101486082111543
DCS:  0.19328547952492378
0.6
Loading test set for subj
Subject  Brats17_CBICA_AQG_1_t2_unbiased.nii.gz  Number of Slices:  140
AUC :  0.7112347975267
DCS:  0.2254532982596899
0.62
Loading test set for subj
Subject  Brats17_2013_0_1_t2_unbiased.nii.gz  Number of Slices:  127
AUC :  0.7138030910261333
DCS:  0.26526039173346644
0.64
Loading test set for subj
Subject  Brats17_TCIA_205_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.7119327249848562
DCS:  0.2754791176025755
0.66
Loading test set for subj
Subject  Brats17_TCIA_177_1_t2_unbiased.nii.gz  Number of Slices:  124
AUC :  0.7096704276745821
DCS:  0.011560167804372851
0.68
Loading test set for subj
Subject  Brats17_TCIA_413_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.706094525502996
DCS:  0.0210752225040008
0.7
Loading test set for subj
Subject  Brats17_CBICA_ASU_1_t2_unbiased.nii.gz  Number of Slices:  134
AUC :  0.7014534221158231
DCS:  0.03261499342023472
0.72
Loading test set for subj
Subject  Brats17_TCIA_630_1_t2_unbiased.nii.gz  Number of Slices:  133
AUC :  0.7027059881333193
DCS:  0.22262157690983447
0.74
Loading test set for subj
Subject  Brats17_CBICA_ABO_1_t2_unbiased.nii.gz  Number of Slices:  144
AUC :  0.6974953407672592
DCS:  0.1752768482829053
0.76
Loading test set for subj
Subject  Brats17_2013_13_1_t2_unbiased.nii.gz  Number of Slices:  136
AUC :  0.6952812955252021
DCS:  0.006473477970944274
0.78
Loading test set for subj
Subject  Brats17_TCIA_607_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.6948069686398499
DCS:  0.12054924070200963
0.8
Loading test set for subj
Subject  Brats17_TCIA_402_1_t2_unbiased.nii.gz  Number of Slices:  142
AUC :  0.7012479669461331
DCS:  0.523507375559639
0.82
Loading test set for subj
Subject  Brats17_TCIA_131_1_t2_unbiased.nii.gz  Number of Slices:  130
AUC :  0.7010694571462465
DCS:  0.12654111721485006
0.84
Loading test set for subj
Subject  Brats17_TCIA_374_1_t2_unbiased.nii.gz  Number of Slices:  137
AUC :  0.7056870252556926
DCS:  0.4330889615196538
0.86
Loading test set for subj
Subject  Brats17_TCIA_603_1_t2_unbiased.nii.gz  Number of Slices:  147
AUC :  0.7022523909815694
DCS:  0.18661461461461462
0.88
Loading test set for subj
Subject  Brats17_TCIA_101_1_t2_unbiased.nii.gz  Number of Slices:  135
AUC :  0.7035738272399017
DCS:  0.11593802922912877
0.9
Loading test set for subj
Subject  Brats17_TCIA_448_1_t2_unbiased.nii.gz  Number of Slices:  127
AUC :  0.7010780406056775
DCS:  0.08024493459861504
0.92
Loading test set for subj
Subject  Brats17_TCIA_621_1_t2_unbiased.nii.gz  Number of Slices:  145
AUC :  0.7025625187466696
DCS:  0.15872878420505715
0.94
Loading test set for subj
Subject  Brats17_TCIA_234_1_t2_unbiased.nii.gz  Number of Slices:  133
AUC :  0.7024601400667693
DCS:  0.16074334046015035
0.96
Loading test set for subj
Subject  Brats17_TCIA_130_1_t2_unbiased.nii.gz  Number of Slices:  130
AUC :  0.7032519135946647
DCS:  0.15119216414869865
0.98
Loading test set for subj
Subject  Brats17_CBICA_AME_1_t2_unbiased.nii.gz  Number of Slices:  144
AUC :  0.702126816848283
DCS:  0.10987462674761217
All AUC:  0.702126816848283
Mean All DCS:  0.2100217086536721
Std ALL DCS:  0.1377548208613251
[Brats17_TCIA_141_1_t2_unbiased.nii.gz]
 Vae model:  camcan_400_Aug_6_100  NN model:  1subj_1e1_10steps_2fch3sh_DCS_1_200
Using device: cuda:0
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'networks.vae_bilinear_conv.ResBlock_Down' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'networks.vae_bilinear_conv.ResBlock_Up' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'models.shallow_UNET.shallow_UNet' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
Loading train set for subj
Traceback (most recent call last):
  File "restore_MAP_NN.py", line 79, in <module>
    device, name, riter, step_rate)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/utils/threshold.py", line 373, in compute_threshold_subj
    step_size=step_size, log=False)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/restoration.py", line 96, in run_map_GGNN
    pyx_grad = net(NN_input.detach()).squeeze(1) * ELBO_grad.detach()
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/models/shallow_UNET.py", line 58, in forward
    bottleneck = self.bottleneck(self.pool2(enc2))
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/container.py", line 100, in forward
    input = module(input)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 345, in forward
    return self.conv2d_forward(input, self.weight)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 342, in conv2d_forward
    self.padding, self.dilation, self.groups)
RuntimeError: Given groups=1, weight of size 16 8 3 3, expected input[32, 4, 32, 32] to have 8 channels, but got 4 channels instead
[Brats17_TCIA_141_1_t2_unbiased.nii.gz]
 Vae model:  camcan_400_Aug_6_100  NN model:  1subj_1e1_10steps_2fch3sh_DCS_1_400
Using device: cuda:0
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'networks.vae_bilinear_conv.ResBlock_Down' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'networks.vae_bilinear_conv.ResBlock_Up' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/serialization.py:593: SourceChangeWarning: source code of class 'models.shallow_UNET.shallow_UNet' has changed. you can retrieve the original source code by accessing the object's source attribute or set `torch.nn.Module.dump_patches = True` and use the patch tool to revert the changes.
  warnings.warn(msg, SourceChangeWarning)
Loading train set for subj
Traceback (most recent call last):
  File "restore_MAP_NN.py", line 79, in <module>
    device, name, riter, step_rate)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/utils/threshold.py", line 373, in compute_threshold_subj
    step_size=step_size, log=False)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/restoration.py", line 96, in run_map_GGNN
    pyx_grad = net(NN_input.detach()).squeeze(1) * ELBO_grad.detach()
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/code_home/restor_MAP/models/shallow_UNET.py", line 58, in forward
    bottleneck = self.bottleneck(self.pool2(enc2))
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/container.py", line 100, in forward
    input = module(input)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/module.py", line 532, in __call__
    result = self.forward(*input, **kwargs)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 345, in forward
    return self.conv2d_forward(input, self.weight)
  File "/scratch_net/biwidl214/jonatank/anaconda3/envs/JKMT/lib/python3.7/site-packages/torch/nn/modules/conv.py", line 342, in conv2d_forward
    self.padding, self.dilation, self.groups)
RuntimeError: Given groups=1, weight of size 16 8 3 3, expected input[32, 4, 32, 32] to have 8 channels, but got 4 channels instead
